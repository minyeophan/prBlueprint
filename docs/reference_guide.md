# Blueprint í”„ë¡œì íŠ¸ ì™„ë²½ ê°€ì´ë“œ

> ì´ ë¬¸ì„œëŠ” ì´ˆë³´ìê°€ ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ì²˜ìŒë¶€í„° ë§Œë“¤ ë•Œ ì°¸ê³ í•  ìˆ˜ ìˆëŠ” ì™„ë²½í•œ ì´ì •í‘œì…ë‹ˆë‹¤.
> ê° í•­ëª©ë§ˆë‹¤ "ì™œ ì´ë ‡ê²Œ ì§°ëŠ”ì§€"ë¥¼ ìƒì„¸íˆ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ëª©ì°¨

1. [ì¸í”„ë¼ ë° í™˜ê²½ ì„¤ì •](#1-ì¸í”„ë¼-ë°-í™˜ê²½-ì„¤ì •-infrastructure)
2. [í•µì‹¬ ì„¤ì • ë° ì„¤ê³„ ê·¼ê±°](#2-í•µì‹¬-ì„¤ì •configuration-ë°-ì„¤ê³„-ê·¼ê±°)
3. [í”„ë¡œì íŠ¸ êµ¬ì¡° ë° í”„ë¡œí•„ ì „ëµ](#3-í”„ë¡œì íŠ¸-êµ¬ì¡°-ë°-í”„ë¡œí•„-ì „ëµ)
4. [ì´ˆë³´ìë¥¼ ìœ„í•œ ì—ëŸ¬ ì˜ˆë°© ë…¸íŠ¸](#4-ì´ˆë³´ìë¥¼-ìœ„í•œ-ì—ëŸ¬-ì˜ˆë°©-ë…¸íŠ¸)
5. [ë¶€ë¡: ë¹ ë¥¸ ì°¸ì¡° ì²´í¬ë¦¬ìŠ¤íŠ¸](#5-ë¶€ë¡-ë¹ ë¥¸-ì°¸ì¡°-ì²´í¬ë¦¬ìŠ¤íŠ¸)

---

# 1. ì¸í”„ë¼ ë° í™˜ê²½ ì„¤ì • (Infrastructure)

## 1.1 Docker & Docker Compose

### 1.1.1 ì™œ Dockerë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Docker ì—†ì´ ê°œë°œí•  ë•Œ ë¬¸ì œì                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ê°œë°œì Aì˜ ë¡œì»¬ í™˜ê²½:                                               â”‚
â”‚  - PostgreSQL 14.2                                                  â”‚
â”‚  - Windows 11                                                       â”‚
â”‚  - Java 17.0.1                                                      â”‚
â”‚                                                                     â”‚
â”‚  ê°œë°œì Bì˜ ë¡œì»¬ í™˜ê²½:                                               â”‚
â”‚  - PostgreSQL 15.1                                                  â”‚
â”‚  - macOS Ventura                                                    â”‚
â”‚  - Java 17.0.5                                                      â”‚
â”‚                                                                     â”‚
â”‚  í”„ë¡œë•ì…˜ ì„œë²„:                                                       â”‚
â”‚  - PostgreSQL 13.0                                                  â”‚
â”‚  - Ubuntu 22.04                                                     â”‚
â”‚  - Java 17.0.3                                                      â”‚
â”‚                                                                     â”‚
â”‚  â†’ "ë‚´ ì»´í“¨í„°ì—ì„œëŠ” ë˜ëŠ”ë°?" ë¬¸ì œ ë°œìƒ! âŒ                            â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Docker ì‚¬ìš© ì‹œ                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ëª¨ë“  í™˜ê²½ì—ì„œ ë™ì¼í•œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰:                                   â”‚
â”‚  - PostgreSQL 15-alpine (ì •í™•íˆ ê°™ì€ ë²„ì „)                           â”‚
â”‚  - Redis 7-alpine (ì •í™•íˆ ê°™ì€ ë²„ì „)                                 â”‚
â”‚  - ë™ì¼í•œ ì„¤ì •, ë™ì¼í•œ í¬íŠ¸                                           â”‚
â”‚                                                                     â”‚
â”‚  â†’ "ì–´ë””ì„œë“  ë™ì¼í•˜ê²Œ ë™ì‘!" âœ…                                       â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì´ˆë³´ìë¥¼ ìœ„í•œ Why:**
- DockerëŠ” "ê°€ìƒ ì»´í“¨í„°"ë¼ê³  ìƒê°í•˜ë©´ ë©ë‹ˆë‹¤
- ë‚´ ì»´í“¨í„°ì— PostgreSQLì„ ì§ì ‘ ì„¤ì¹˜í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤
- í”„ë¡œì íŠ¸ë¥¼ ì‚­ì œí•˜ë©´ DBë„ ê¹”ë”í•˜ê²Œ ì‚­ì œë©ë‹ˆë‹¤
- íŒ€ì› ëª¨ë‘ê°€ ê°™ì€ í™˜ê²½ì—ì„œ ê°œë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

### 1.1.2 docker-compose.yml ìƒì„¸ í•´ì„¤

```yaml
# docker-compose.yml ì „ì²´ êµ¬ì¡°

services:          # ì‹¤í–‰í•  ì»¨í…Œì´ë„ˆë“¤ ì •ì˜
  postgres:        # ì„œë¹„ìŠ¤ ì´ë¦„ (ì„ì˜ë¡œ ì§€ì •)
  redis:           # ì„œë¹„ìŠ¤ ì´ë¦„
  backend:         # ì„œë¹„ìŠ¤ ì´ë¦„
  frontend:        # ì„œë¹„ìŠ¤ ì´ë¦„

networks:          # ì»¨í…Œì´ë„ˆ ê°„ í†µì‹  ë„¤íŠ¸ì›Œí¬
volumes:           # ë°ì´í„° ì˜êµ¬ ì €ì¥ì†Œ
```

#### PostgreSQL ì„œë¹„ìŠ¤ ìƒì„¸ ì„¤ëª…

```yaml
postgres:
  image: postgres:15-alpine
  # â†‘ ì‚¬ìš©í•  ì´ë¯¸ì§€ì™€ ë²„ì „
  #
  # ğŸ” ì™œ postgres:15-alpineì¸ê°€?
  # - postgres:15 â†’ PostgreSQL ë²„ì „ 15 (ìµœì‹  ì•ˆì • ë²„ì „)
  # - alpine â†’ ê²½ëŸ‰ ë¦¬ëˆ…ìŠ¤ ê¸°ë°˜ (ìš©ëŸ‰ ì‘ìŒ: ~50MB vs ì¼ë°˜ ~300MB)
  # - ê°œë°œ í™˜ê²½ì—ì„œëŠ” alpineìœ¼ë¡œ ì¶©ë¶„!
  # - í”„ë¡œë•ì…˜ì—ì„œë„ alpine ì‚¬ìš© ê°€ëŠ¥ (ì„±ëŠ¥ ì°¨ì´ ì—†ìŒ)
  #
  # âš ï¸ ì£¼ì˜: latest íƒœê·¸ëŠ” ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”!
  # - postgres:latest â†’ ì–´ëŠ ë‚  ê°‘ìê¸° ë²„ì „ì´ ë°”ë€” ìˆ˜ ìˆìŒ
  # - ë²„ì „ì„ ëª…ì‹œí•´ì•¼ "ì¬í˜„ ê°€ëŠ¥í•œ í™˜ê²½"ì´ ë©ë‹ˆë‹¤

  container_name: blueprint-db
  # â†‘ ì»¨í…Œì´ë„ˆ ì´ë¦„ (docker psì—ì„œ ë³´ì´ëŠ” ì´ë¦„)
  #
  # ğŸ” ì™œ ì´ë¦„ì„ ì§€ì •í•˜ëŠ”ê°€?
  # - ì§€ì • ì•ˆí•˜ë©´: blueprint-postgres-1 (ìë™ ìƒì„±)
  # - ì§€ì •í•˜ë©´: blueprint-db (ëª…í™•í•˜ê³  ì§§ìŒ)
  # - ë¡œê·¸ í™•ì¸í•  ë•Œ í¸í•¨: docker logs blueprint-db

  environment:
    POSTGRES_DB: blueprint
    # â†‘ ìë™ìœ¼ë¡œ ìƒì„±ë  ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„
    #
    # ğŸ” ì™œ blueprintì¸ê°€?
    # - í”„ë¡œì íŠ¸ ì´ë¦„ê³¼ ì¼ì¹˜ì‹œì¼œì„œ í˜¼ë™ ë°©ì§€
    # - ë‚˜ì¤‘ì— "ì–´ë–¤ DBê°€ ì–´ë–¤ í”„ë¡œì íŠ¸ìš©ì¸ì§€" ì•Œ ìˆ˜ ìˆìŒ

    POSTGRES_USER: blueprint
    # â†‘ DB ì ‘ì† ì‚¬ìš©ìëª…
    #
    # ğŸ” ì™œ postgresê°€ ì•„ë‹Œ blueprintì¸ê°€?
    # - postgresëŠ” ìŠˆí¼ìœ ì € (ë„ˆë¬´ ê°•ë ¥í•œ ê¶Œí•œ)
    # - í”„ë¡œì íŠ¸ ì „ìš© ì‚¬ìš©ìë¥¼ ë§Œë“œëŠ” ê²ƒì´ ë³´ì•ˆìƒ ì¢‹ìŒ
    # - ì‹¤ìˆ˜ë¡œ ë‹¤ë¥¸ DBë¥¼ ê±´ë“œë¦´ ìœ„í—˜ ê°ì†Œ

    POSTGRES_PASSWORD: ${DB_PASSWORD:-blueprint123}
    # â†‘ DB ì ‘ì† ë¹„ë°€ë²ˆí˜¸
    #
    # ğŸ” ì´ ë¬¸ë²•ì˜ ì˜ë¯¸:
    # - ${DB_PASSWORD:-blueprint123}
    # - í™˜ê²½ë³€ìˆ˜ DB_PASSWORDê°€ ìˆìœ¼ë©´ â†’ ê·¸ ê°’ ì‚¬ìš©
    # - í™˜ê²½ë³€ìˆ˜ê°€ ì—†ìœ¼ë©´ â†’ blueprint123 ì‚¬ìš© (ê¸°ë³¸ê°’)
    #
    # âœ… ì¥ì :
    # - ê°œë°œ í™˜ê²½: ê¸°ë³¸ê°’ìœ¼ë¡œ í¸í•˜ê²Œ ì‚¬ìš©
    # - í”„ë¡œë•ì…˜: í™˜ê²½ë³€ìˆ˜ë¡œ ì•ˆì „í•œ ë¹„ë°€ë²ˆí˜¸ ì£¼ì…

  ports:
    - "5432:5432"
    # â†‘ í¬íŠ¸ ë§¤í•‘ (í˜¸ìŠ¤íŠ¸:ì»¨í…Œì´ë„ˆ)
    #
    # ğŸ” ì´ ìˆ«ìë“¤ì˜ ì˜ë¯¸:
    # - ì™¼ìª½ 5432: ë‚´ ì»´í“¨í„°(í˜¸ìŠ¤íŠ¸)ì˜ í¬íŠ¸
    # - ì˜¤ë¥¸ìª½ 5432: ì»¨í…Œì´ë„ˆ ì•ˆì˜ í¬íŠ¸
    # - "ë‚´ ì»´í“¨í„°ì˜ 5432ë¡œ ì ‘ì†í•˜ë©´ ì»¨í…Œì´ë„ˆì˜ 5432ë¡œ ì—°ê²°"
    #
    # ğŸ” ì™œ 5432ì¸ê°€?
    # - PostgreSQLì˜ ê¸°ë³¸ í¬íŠ¸ ë²ˆí˜¸
    # - ë‹¤ë¥¸ í¬íŠ¸ë„ ê°€ëŠ¥ (ì˜ˆ: "5433:5432")
    # - ê¸°ë³¸ í¬íŠ¸ë¥¼ ì“°ë©´ ë„êµ¬ë“¤ì´ ìë™ ì¸ì‹

  volumes:
    - postgres_data:/var/lib/postgresql/data
    # â†‘ ë°ì´í„° ì˜êµ¬ ì €ì¥
    #
    # ğŸ” ì™œ volumesê°€ í•„ìš”í•œê°€?
    # - ì»¨í…Œì´ë„ˆëŠ” "íœ˜ë°œì„±" (ì‚­ì œí•˜ë©´ ë°ì´í„°ë„ ì‚­ì œ)
    # - volumesë¡œ ë°ì´í„°ë¥¼ ì»¨í…Œì´ë„ˆ ë°–ì— ì €ì¥
    # - ì»¨í…Œì´ë„ˆë¥¼ ì‚­ì œí•´ë„ ë°ì´í„°ëŠ” ìœ ì§€!
    #
    # ğŸ” ê²½ë¡œì˜ ì˜ë¯¸:
    # - postgres_data â†’ ë³¼ë¥¨ ì´ë¦„ (ì•„ë˜ volumes: ì„¹ì…˜ì—ì„œ ì •ì˜)
    # - /var/lib/postgresql/data â†’ PostgreSQLì´ ë°ì´í„° ì €ì¥í•˜ëŠ” ê²½ë¡œ

  healthcheck:
    test: ["CMD-SHELL", "pg_isready -U blueprint"]
    # â†‘ ì»¨í…Œì´ë„ˆê°€ "ì¤€ë¹„ëëŠ”ì§€" í™•ì¸í•˜ëŠ” ëª…ë ¹
    #
    # ğŸ” ì™œ healthcheckê°€ í•„ìš”í•œê°€?
    # - ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ëë‹¤ê³  ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ ê±´ ì•„ë‹˜
    # - PostgreSQLì´ ì™„ì „íˆ ì´ˆê¸°í™”ë  ë•Œê¹Œì§€ ì‹œê°„ í•„ìš”
    # - healthcheckë¡œ "ì§„ì§œ ì¤€ë¹„ëëŠ”ì§€" í™•ì¸
    #
    # ğŸ” pg_isreadyë€?
    # - PostgreSQL ë‚´ì¥ ëª…ë ¹ì–´
    # - "DBê°€ ì ‘ì† ê°€ëŠ¥í•œê°€?" í™•ì¸
    # - -U blueprint: blueprint ì‚¬ìš©ìë¡œ í™•ì¸

    interval: 10s      # 10ì´ˆë§ˆë‹¤ í™•ì¸
    timeout: 5s        # 5ì´ˆ ì•ˆì— ì‘ë‹µ ì—†ìœ¼ë©´ ì‹¤íŒ¨
    retries: 5         # 5ë²ˆ ì‹¤íŒ¨í•˜ë©´ unhealthy

  networks:
    - blueprint-network
    # â†‘ ì´ ì»¨í…Œì´ë„ˆê°€ ì†í•  ë„¤íŠ¸ì›Œí¬
    #
    # ğŸ” ì™œ ë„¤íŠ¸ì›Œí¬ê°€ í•„ìš”í•œê°€?
    # - ê°™ì€ ë„¤íŠ¸ì›Œí¬ì˜ ì»¨í…Œì´ë„ˆë¼ë¦¬ í†µì‹  ê°€ëŠ¥
    # - ì»¨í…Œì´ë„ˆ ì´ë¦„ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥ (postgres:5432)
    # - IP ì£¼ì†Œë¥¼ ëª°ë¼ë„ ë¨!
```

#### Redis ì„œë¹„ìŠ¤ ìƒì„¸ ì„¤ëª…

```yaml
redis:
  image: redis:7-alpine
  # â†‘ Redis ë²„ì „ 7, ê²½ëŸ‰ ì´ë¯¸ì§€
  #
  # ğŸ” ì™œ Redisë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?
  # 1. ìºì‹±: DB ì¡°íšŒ ê²°ê³¼ë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥ â†’ ë¹ ë¥¸ ì‘ë‹µ
  # 2. ì„¸ì…˜: JWT Refresh Token ì €ì¥
  # 3. Pub/Sub: ì„œë²„ ê°„ ì‹¤ì‹œê°„ ë©”ì‹œì§€ ì „ë‹¬
  #
  # ğŸ” ì™œ ë²„ì „ 7ì¸ê°€?
  # - Redis 7ì€ 2022ë…„ ì¶œì‹œëœ ìµœì‹  ë©”ì´ì € ë²„ì „
  # - ì„±ëŠ¥ ê°œì„ , ìƒˆë¡œìš´ ê¸°ëŠ¥ë“¤ í¬í•¨
  # - ì•ˆì •ì ì´ê³  ë„ë¦¬ ì‚¬ìš©ë¨

  container_name: blueprint-redis

  ports:
    - "6379:6379"
    # â†‘ Redisì˜ ê¸°ë³¸ í¬íŠ¸ ë²ˆí˜¸
    #
    # ğŸ” ì™œ 6379ì¸ê°€?
    # - Redis ì°½ì‹œìê°€ "MERZ"ë¥¼ ì „í™”ê¸° í‚¤íŒ¨ë“œë¡œ ëˆ„ë¥´ë©´ 6379
    # - MERZëŠ” ì´íƒˆë¦¬ì•„ ê°€ìˆ˜ ì´ë¦„ (ë†ë‹´ ì•„ë‹˜, ì§„ì§œì„)

  volumes:
    - redis_data:/data
    # â†‘ Redis ë°ì´í„° ì˜êµ¬ ì €ì¥
    #
    # ğŸ” ì™œ /dataì¸ê°€?
    # - Redisì˜ ê¸°ë³¸ ë°ì´í„° ë””ë ‰í† ë¦¬
    # - RDB ìŠ¤ëƒ…ìƒ·, AOF ë¡œê·¸ íŒŒì¼ ì €ì¥ ìœ„ì¹˜

  healthcheck:
    test: ["CMD", "redis-cli", "ping"]
    # â†‘ redis-cli ping â†’ "PONG" ì‘ë‹µ í™•ì¸
    #
    # ğŸ” PING-PONGì´ë€?
    # - Redisì— "ì‚´ì•„ìˆì–´?" ë¬¼ìœ¼ë©´ "PONG" ì‘ë‹µ
    # - ê°€ì¥ ê°„ë‹¨í•œ ì—°ê²° í™•ì¸ ë°©ë²•

    interval: 10s
    timeout: 5s
    retries: 5
```

#### Backend ì„œë¹„ìŠ¤ ìƒì„¸ ì„¤ëª…

```yaml
backend:
  build:
    context: ./backend
    dockerfile: Dockerfile
    # â†‘ ì´ë¯¸ì§€ë¥¼ ì§ì ‘ ë¹Œë“œ
    #
    # ğŸ” image vs build ì°¨ì´:
    # - image: ì´ë¯¸ ë§Œë“¤ì–´ì§„ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ (postgres, redis)
    # - build: Dockerfileë¡œ ì§ì ‘ ì´ë¯¸ì§€ ìƒì„± (ìš°ë¦¬ ì•±)
    #
    # ğŸ” contextë€?
    # - Dockerfileì˜ ê¸°ì¤€ ë””ë ‰í† ë¦¬
    # - ./backend í´ë”ë¥¼ ê¸°ì¤€ìœ¼ë¡œ Dockerfile ì‹¤í–‰

  container_name: blueprint-backend

  environment:
    SPRING_PROFILES_ACTIVE: docker
    # â†‘ Spring í”„ë¡œí•„ ì§€ì •
    #
    # ğŸ” ì™œ docker í”„ë¡œí•„ì¸ê°€?
    # - application-docker.yml ì„¤ì •ì„ ì‚¬ìš©
    # - ì»¨í…Œì´ë„ˆ í™˜ê²½ì— ë§ëŠ” ì„¤ì • (DB í˜¸ìŠ¤íŠ¸ê°€ postgres ë“±)

    SPRING_DATASOURCE_URL: jdbc:postgresql://postgres:5432/blueprint
    # â†‘ DB ì—°ê²° URL
    #
    # ğŸ” URL êµ¬ì¡° í•´ì„:
    # - jdbc:postgresql:// â†’ JDBC ë“œë¼ì´ë²„ ì‚¬ìš©, PostgreSQL
    # - postgres â†’ í˜¸ìŠ¤íŠ¸ëª… (ì»¨í…Œì´ë„ˆ ì´ë¦„!)
    # - :5432 â†’ í¬íŠ¸
    # - /blueprint â†’ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„
    #
    # âš ï¸ ì¤‘ìš”: localhostê°€ ì•„ë‹Œ postgres!
    # - ì»¨í…Œì´ë„ˆ ê°„ í†µì‹ ì€ ì»¨í…Œì´ë„ˆ ì´ë¦„ìœ¼ë¡œ!

    REDIS_HOST: redis
    # â†‘ Redis í˜¸ìŠ¤íŠ¸ë„ ì»¨í…Œì´ë„ˆ ì´ë¦„

    REDIS_PORT: 6379

    JWT_SECRET: ${JWT_SECRET:-your-super-secret-jwt-key-for-docker-development-min-256-bits}
    # â†‘ JWT ì„œëª… ë¹„ë°€ í‚¤
    #
    # ğŸ” ì™œ ì´ë ‡ê²Œ ê¸´ê°€?
    # - JWTëŠ” HMAC-SHA256 ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©
    # - ìµœì†Œ 256ë¹„íŠ¸(32ë°”ì´íŠ¸) í‚¤ í•„ìš”
    # - ì§§ìœ¼ë©´ ì—ëŸ¬ ë°œìƒ!

  depends_on:
    postgres:
      condition: service_healthy
    redis:
      condition: service_healthy
    # â†‘ ì˜ì¡´ì„± ë° ì‹œì‘ ì¡°ê±´
    #
    # ğŸ” ì™œ depends_onì´ í•„ìš”í•œê°€?
    # - Backendê°€ ì‹œì‘ë˜ê¸° ì „ì— DBê°€ ì¤€ë¹„ë˜ì–´ì•¼ í•¨
    # - ë‹¨ìˆœ depends_onì€ "ì‹œì‘ ìˆœì„œ"ë§Œ ë³´ì¥
    # - condition: service_healthyëŠ” "ì¤€ë¹„ ì™„ë£Œ"ê¹Œì§€ ëŒ€ê¸°
    #
    # ğŸ” ì‹œì‘ ìˆœì„œ:
    # 1. postgres, redis ì‹œì‘
    # 2. healthcheck í†µê³¼ ëŒ€ê¸°
    # 3. backend ì‹œì‘

  healthcheck:
    test: ["CMD", "wget", "--spider", "-q", "http://localhost:8080/actuator/health"]
    # â†‘ Spring Actuator í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ
    #
    # ğŸ” ì™œ wgetì„ ì‚¬ìš©í•˜ëŠ”ê°€?
    # - curlì´ ì—†ëŠ” ê²½ëŸ‰ ì´ë¯¸ì§€ë„ ìˆìŒ
    # - wgetì€ ëŒ€ë¶€ë¶„ ì´ë¯¸ì§€ì— í¬í•¨
    # - --spider: ë‹¤ìš´ë¡œë“œ ì—†ì´ í™•ì¸ë§Œ
    # - -q: ì¡°ìš©íˆ (ì¶œë ¥ ì—†ì´)

    start_period: 60s
    # â†‘ ì‹œì‘ í›„ 60ì´ˆê°„ ì‹¤íŒ¨í•´ë„ unhealthyë¡œ ì•ˆ ì¹¨
    #
    # ğŸ” ì™œ start_periodê°€ í•„ìš”í•œê°€?
    # - Spring Boot ì•±ì€ ì‹œì‘ì´ ëŠë¦¼ (10~30ì´ˆ)
    # - ì‹œì‘ ì¤‘ì— healthcheck ì‹¤íŒ¨í•˜ë©´ ì•ˆ ë¨
    # - 60ì´ˆê°„ ì—¬ìœ ë¥¼ ì¤Œ
```

#### Networksì™€ Volumes

```yaml
networks:
  blueprint-network:
    driver: bridge
    # â†‘ ë„¤íŠ¸ì›Œí¬ ì •ì˜
    #
    # ğŸ” bridge ë“œë¼ì´ë²„ë€?
    # - Dockerì˜ ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ ë“œë¼ì´ë²„
    # - ê°™ì€ ë„¤íŠ¸ì›Œí¬ì˜ ì»¨í…Œì´ë„ˆë¼ë¦¬ í†µì‹  ê°€ëŠ¥
    # - ì™¸ë¶€ì—ì„œëŠ” ì ‘ê·¼ ë¶ˆê°€ (í¬íŠ¸ ë§¤í•‘ í•„ìš”)
    #
    # ğŸ” ì™œ ì»¤ìŠ¤í…€ ë„¤íŠ¸ì›Œí¬ë¥¼ ë§Œë“œëŠ”ê°€?
    # - ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬: ì»¨í…Œì´ë„ˆ ì´ë¦„ìœ¼ë¡œ ì ‘ê·¼ ë¶ˆê°€
    # - ì»¤ìŠ¤í…€ ë„¤íŠ¸ì›Œí¬: ì»¨í…Œì´ë„ˆ ì´ë¦„ìœ¼ë¡œ DNS ìë™ í•´ì„!

volumes:
  postgres_data:
  redis_data:
    # â†‘ ë³¼ë¥¨ ì •ì˜
    #
    # ğŸ” Named Volumeì´ë€?
    # - Dockerê°€ ê´€ë¦¬í•˜ëŠ” ì €ì¥ì†Œ
    # - ìœ„ì¹˜: /var/lib/docker/volumes/... (ìë™ ê´€ë¦¬)
    # - ì¥ì : ë°±ì—…, ë§ˆì´ê·¸ë ˆì´ì…˜ ì‰¬ì›€
    #
    # ğŸ” Bind Mountì™€ì˜ ì°¨ì´:
    # - Named Volume: Dockerê°€ ê´€ë¦¬, ìœ„ì¹˜ ëª°ë¼ë„ ë¨
    # - Bind Mount: ë‚´ê°€ ì§€ì •í•œ í´ë” (-v ./data:/data)
```

### 1.1.3 ìì£¼ ì“°ëŠ” Docker ëª…ë ¹ì–´

```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ ì‹œì‘ (ë°±ê·¸ë¼ìš´ë“œ)
docker-compose up -d

# ë¡œê·¸ í™•ì¸
docker-compose logs -f backend

# íŠ¹ì • ì„œë¹„ìŠ¤ë§Œ ì¬ì‹œì‘
docker-compose restart backend

# ëª¨ë“  ì„œë¹„ìŠ¤ ì¤‘ì§€ ë° ì‚­ì œ
docker-compose down

# ë³¼ë¥¨ê¹Œì§€ ì‚­ì œ (âš ï¸ ë°ì´í„° ì‚­ì œë¨!)
docker-compose down -v

# ì´ë¯¸ì§€ ìƒˆë¡œ ë¹Œë“œ
docker-compose build --no-cache

# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì ‘ì†
docker exec -it blueprint-backend sh

# PostgreSQL CLI ì ‘ì†
docker exec -it blueprint-db psql -U blueprint -d blueprint

# Redis CLI ì ‘ì†
docker exec -it blueprint-redis redis-cli
```

---

## 1.2 Gradle ì˜ì¡´ì„± (build.gradle)

### 1.2.1 ì˜ì¡´ì„± êµ¬ì¡° ì´í•´

```groovy
dependencies {
    // ì˜ì¡´ì„± ì¢…ë¥˜:
    // - implementation: ì»´íŒŒì¼ + ëŸ°íƒ€ì„ì— í•„ìš”
    // - compileOnly: ì»´íŒŒì¼ ì‹œì—ë§Œ í•„ìš” (Lombok)
    // - runtimeOnly: ëŸ°íƒ€ì„ì—ë§Œ í•„ìš” (DB ë“œë¼ì´ë²„)
    // - annotationProcessor: ì»´íŒŒì¼ ì‹œ ì½”ë“œ ìƒì„± (Lombok)
    // - testImplementation: í…ŒìŠ¤íŠ¸ì—ë§Œ í•„ìš”
}
```

### 1.2.2 ê° ì˜ì¡´ì„± ìƒì„¸ ì„¤ëª…

#### Spring Boot Core

```groovy
implementation 'org.springframework.boot:spring-boot-starter-web'
```

**ğŸ” ì™œ í•„ìš”í•œê°€?**
- HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬ (REST API)
- ë‚´ì¥ Tomcat ì„œë²„ í¬í•¨
- JSON ì§ë ¬í™”/ì—­ì§ë ¬í™” (Jackson)

**í¬í•¨ë˜ëŠ” ê²ƒ:**
- Spring MVC (@RestController, @GetMapping ë“±)
- ë‚´ì¥ Tomcat
- Jackson JSON ë¼ì´ë¸ŒëŸ¬ë¦¬
- Bean Validation

---

```groovy
implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
```

**ğŸ” ì™œ í•„ìš”í•œê°€?**
- ë°ì´í„°ë² ì´ìŠ¤ì™€ ê°ì²´(Java í´ë˜ìŠ¤)ë¥¼ ë§¤í•‘
- SQLì„ ì§ì ‘ ì“°ì§€ ì•Šê³  Java ì½”ë“œë¡œ DB ì¡°ì‘
- ë°˜ë³µì ì¸ CRUD ì½”ë“œ ìë™ ìƒì„±

**í¬í•¨ë˜ëŠ” ê²ƒ:**
- Spring Data JPA (JpaRepository)
- Hibernate (JPA êµ¬í˜„ì²´)
- HikariCP (ì»¤ë„¥ì…˜ í’€)

**ì˜ˆì‹œ:**
```java
// SQL ì—†ì´ DB ì¡°íšŒ ê°€ëŠ¥!
public interface UserRepository extends JpaRepository<User, Long> {
    Optional<User> findByEmail(String email);
    // â†’ SELECT * FROM users WHERE email = ?
}
```

---

```groovy
implementation 'org.springframework.boot:spring-boot-starter-validation'
```

**ğŸ” ì™œ í•„ìš”í•œê°€?**
- ì…ë ¥ê°’ ê²€ì¦ ìë™í™”
- @Valid, @NotNull, @Email ë“± ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš©

**ì˜ˆì‹œ:**
```java
public class SignupRequest {
    @NotBlank(message = "ì´ë©”ì¼ì€ í•„ìˆ˜ì…ë‹ˆë‹¤")
    @Email(message = "ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤")
    private String email;

    @Size(min = 8, message = "ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤")
    private String password;
}
```

---

```groovy
implementation 'org.springframework.boot:spring-boot-starter-actuator'
```

**ğŸ” ì™œ í•„ìš”í•œê°€?**
- ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ ëª¨ë‹ˆí„°ë§
- í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸ ì œê³µ (/actuator/health)
- Docker, Kubernetes ì—°ë™ì— í•„ìˆ˜

**ì œê³µ ì—”ë“œí¬ì¸íŠ¸:**
- `/actuator/health` - ì•±ì´ ì‚´ì•„ìˆëŠ”ì§€ í™•ì¸
- `/actuator/info` - ì•± ì •ë³´
- `/actuator/metrics` - ì„±ëŠ¥ ì§€í‘œ

---

#### Security & JWT

```groovy
implementation 'org.springframework.boot:spring-boot-starter-security'
```

**ğŸ” ì™œ í•„ìš”í•œê°€?**
- ì¸ì¦(Authentication): "ë„ˆ ëˆ„êµ¬ì•¼?"
- ì¸ê°€(Authorization): "ë„ˆ ì´ê±° í•  ìˆ˜ ìˆì–´?"
- CSRF, CORS, ì„¸ì…˜ ê´€ë¦¬

**ì£¼ì˜:**
- ì¶”ê°€í•˜ë©´ ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ê°€ ê¸°ë³¸ì ìœ¼ë¡œ ë³´í˜¸ë¨
- SecurityConfigë¡œ ì„¸ë¶€ ì„¤ì • í•„ìš”

---

```groovy
implementation 'io.jsonwebtoken:jjwt-api:0.12.5'
runtimeOnly 'io.jsonwebtoken:jjwt-impl:0.12.5'
runtimeOnly 'io.jsonwebtoken:jjwt-jackson:0.12.5'
```

**ğŸ” ì™œ 3ê°œë¡œ ë¶„ë¦¬ë˜ì–´ ìˆëŠ”ê°€?**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    JJWT ë¼ì´ë¸ŒëŸ¬ë¦¬ êµ¬ì¡°                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  jjwt-api (interface)                                               â”‚
â”‚  â”œâ”€â”€ Jwts.builder()                                                 â”‚
â”‚  â”œâ”€â”€ Jwts.parser()                                                  â”‚
â”‚  â””â”€â”€ ê³µê°œ APIë§Œ ì œê³µ                                                 â”‚
â”‚       â”‚                                                             â”‚
â”‚       â”‚ implementation                                              â”‚
â”‚       â–¼                                                             â”‚
â”‚  jjwt-impl (êµ¬í˜„ì²´) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ runtimeOnly                     â”‚
â”‚  â””â”€â”€ ì‹¤ì œ í† í° ìƒì„±/íŒŒì‹± ë¡œì§       (ì»´íŒŒì¼ ì‹œ ë¶ˆí•„ìš”)                 â”‚
â”‚       â”‚                                                             â”‚
â”‚       â”‚ JSON ì§ë ¬í™”                                                 â”‚
â”‚       â–¼                                                             â”‚
â”‚  jjwt-jackson (JSON ì²˜ë¦¬) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ runtimeOnly                    â”‚
â”‚  â””â”€â”€ JWT í˜ì´ë¡œë“œ JSON ë³€í™˜         (ì»´íŒŒì¼ ì‹œ ë¶ˆí•„ìš”)                 â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ” ì™œ ì´ë ‡ê²Œ ë¶„ë¦¬í•˜ëŠ”ê°€?
- ì˜ì¡´ì„± ìµœì†Œí™”: ë‚´ ì½”ë“œëŠ” APIë§Œ ì˜ì¡´
- êµ¬í˜„ì²´ êµì²´ ê°€ëŠ¥: implì„ ë‹¤ë¥¸ ê±¸ë¡œ ë°”ê¿€ ìˆ˜ ìˆìŒ
- ë¹Œë“œ ìµœì í™”: ì»´íŒŒì¼ ì‹œ í•„ìš”í•œ ê²ƒë§Œ ë¡œë“œ
```

---

#### Database Drivers

```groovy
runtimeOnly 'com.h2database:h2'
runtimeOnly 'org.postgresql:postgresql'
```

**ğŸ” ì™œ ë‘˜ ë‹¤ í•„ìš”í•œê°€?**

| DB | ìš©ë„ | í™˜ê²½ |
|----|------|------|
| H2 | ì¸ë©”ëª¨ë¦¬ DB | ê°œë°œ, í…ŒìŠ¤íŠ¸ |
| PostgreSQL | ì‹¤ì œ DB | Docker, í”„ë¡œë•ì…˜ |

**ğŸ” ì™œ runtimeOnlyì¸ê°€?**
- JPAê°€ JDBC ë“œë¼ì´ë²„ë¥¼ ëŸ°íƒ€ì„ì— ë¡œë“œ
- ì»´íŒŒì¼ ì‹œì—ëŠ” JPA ì¸í„°í˜ì´ìŠ¤ë§Œ ì‚¬ìš©
- ë“œë¼ì´ë²„ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ import í•  ì¼ ì—†ìŒ

```java
// ì½”ë“œì—ì„œ ì§ì ‘ ë“œë¼ì´ë²„ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
// JPAê°€ ë‚´ë¶€ì ìœ¼ë¡œ ì‚¬ìš©
@Entity
public class User { ... }  // PostgreSQLì¸ì§€ H2ì¸ì§€ ëª¨ë¦„!
```

---

#### Redis

```groovy
implementation 'org.springframework.boot:spring-boot-starter-data-redis'
```

**ğŸ” ì™œ í•„ìš”í•œê°€?**
1. **ìºì‹±**: DB ì¡°íšŒ ê²°ê³¼ë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥
2. **ì„¸ì…˜**: JWT Refresh Token ì €ì¥
3. **Pub/Sub**: ì„œë²„ ê°„ ì‹¤ì‹œê°„ ë©”ì‹œì§€ ì „ë‹¬

**í¬í•¨ë˜ëŠ” ê²ƒ:**
- Lettuce í´ë¼ì´ì–¸íŠ¸ (ë¹„ë™ê¸°, ê³ ì„±ëŠ¥)
- Spring Cache ì¶”ìƒí™” (@Cacheable)
- RedisTemplate

---

#### Lombok

```groovy
compileOnly 'org.projectlombok:lombok'
annotationProcessor 'org.projectlombok:lombok'
```

**ğŸ” ì™œ compileOnly + annotationProcessorì¸ê°€?**

```java
// Lombok ì—†ì´
public class User {
    private Long id;
    private String email;

    public Long getId() { return id; }
    public void setId(Long id) { this.id = id; }
    public String getEmail() { return email; }
    public void setEmail(String email) { this.email = email; }
    // ... equals, hashCode, toString, ìƒì„±ì ë“±ë“±
}

// Lombok ì‚¬ìš©
@Getter @Setter
@NoArgsConstructor
@AllArgsConstructor
public class User {
    private Long id;
    private String email;
}
// â†’ ì»´íŒŒì¼ ì‹œ ìë™ìœ¼ë¡œ getter/setter ìƒì„±!
```

**ğŸ” ì™œ compileOnlyì¸ê°€?**
- Lombokì€ ì»´íŒŒì¼ ì‹œì—ë§Œ ì½”ë“œ ìƒì„±
- ëŸ°íƒ€ì„ì—ëŠ” ì¼ë°˜ Java ì½”ë“œê°€ ë¨
- JAR íŒŒì¼ì— Lombok í¬í•¨ ë¶ˆí•„ìš”

---

#### WebSocket

```groovy
implementation 'org.springframework.boot:spring-boot-starter-websocket'
```

**ğŸ” ì™œ í•„ìš”í•œê°€?**
- ì‹¤ì‹œê°„ ì–‘ë°©í–¥ í†µì‹ 
- HTTPëŠ” ìš”ì²­-ì‘ë‹µ êµ¬ì¡° (ì„œë²„ê°€ ë¨¼ì € ë³´ë‚¼ ìˆ˜ ì—†ìŒ)
- WebSocketì€ ì—°ê²° ìœ ì§€ (ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì— push ê°€ëŠ¥)

**ì‚¬ìš© ì˜ˆ:**
- ì‹¤ì‹œê°„ í˜‘ì—… (ë‹¤ë¥¸ ì‚¬ëŒì˜ ë³€ê²½ì‚¬í•­ ì¦‰ì‹œ ë°˜ì˜)
- ì±„íŒ…
- ì•Œë¦¼

---

#### Test

```groovy
testImplementation 'org.springframework.boot:spring-boot-starter-test'
testImplementation 'org.springframework.security:spring-security-test'
testImplementation 'org.testcontainers:postgresql:1.19.7'
```

**ğŸ” TestContainersë€?**
- í…ŒìŠ¤íŠ¸ìš© Docker ì»¨í…Œì´ë„ˆ ìë™ ìƒì„±/ì‚­ì œ
- ì‹¤ì œ PostgreSQLë¡œ í…ŒìŠ¤íŠ¸ (H2 ëŒ€ì‹ )
- "í…ŒìŠ¤íŠ¸ì—ì„œë§Œ H2, í”„ë¡œë•ì…˜ì—ì„œ ë²„ê·¸" ë°©ì§€

---

# 2. í•µì‹¬ ì„¤ì •(Configuration) ë° ì„¤ê³„ ê·¼ê±°

## 2.1 Redis ì¥ì•  ë‚´ì„± (CacheErrorHandler)

### 2.1.1 ë¬¸ì œ ìƒí™©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Redis ì—†ì´ ìºì‹±í•  ë•Œ ë¬¸ì œ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ì •ìƒ ìƒí™©:                                                          â”‚
â”‚  Client â†’ API â†’ @Cacheable â†’ Redis â†’ ì‘ë‹µ                           â”‚
â”‚                                                                     â”‚
â”‚  Redis ë‹¤ìš´ ì‹œ (ì¥ì•  ë‚´ì„± ì—†ìŒ):                                      â”‚
â”‚  Client â†’ API â†’ @Cacheable â†’ Redis(ì£½ìŒ) â†’ ì˜ˆì™¸ ë°œìƒ! â†’ 500 ì—ëŸ¬     â”‚
â”‚                                                                     â”‚
â”‚  â†’ ìºì‹œ ì„œë²„ê°€ ì£½ì—ˆì„ ë¿ì¸ë° ì „ì²´ ì„œë¹„ìŠ¤ ì¥ì• ! âŒ                       â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.1.2 í•´ê²°ì±…: CacheErrorHandler

```java
@Configuration
public class CacheConfig extends CachingConfigurerSupport {

    /**
     * Redis ì¥ì•  ì‹œ ì˜ˆì™¸ë¥¼ ì‚¼í‚¤ê³  ë¡œê¹…ë§Œ ìˆ˜í–‰
     * â†’ ë©”ì¸ DB ë¡œì§ì€ ê³„ì† ì‹¤í–‰ë¨
     */
    @Override
    public CacheErrorHandler errorHandler() {
        return new CacheErrorHandler() {

            @Override
            public void handleCacheGetError(RuntimeException e, Cache cache, Object key) {
                // ğŸ” ì´ ë©”ì„œë“œëŠ” ì–¸ì œ í˜¸ì¶œë˜ëŠ”ê°€?
                // @Cacheable ë©”ì„œë“œì—ì„œ Redis ì¡°íšŒ ì‹¤íŒ¨ ì‹œ
                //
                // ğŸ” ì™œ ì˜ˆì™¸ë¥¼ ë˜ì§€ì§€ ì•ŠëŠ”ê°€?
                // - ì˜ˆì™¸ë¥¼ ë˜ì§€ë©´ â†’ API í˜¸ì¶œ ì‹¤íŒ¨ â†’ ì‚¬ìš©ìì—ê²Œ ì—ëŸ¬
                // - ë¡œê·¸ë§Œ ë‚¨ê¸°ë©´ â†’ DBì—ì„œ ì¡°íšŒ â†’ ì‚¬ìš©ìì—ê²Œ ì •ìƒ ì‘ë‹µ
                //
                // ğŸ” ì‚¬ìš©ì ì…ì¥ì—ì„œëŠ”?
                // - Redis ì •ìƒ: 10ms ì‘ë‹µ (ìºì‹œ íˆíŠ¸)
                // - Redis ì¥ì• : 100ms ì‘ë‹µ (DB ì¡°íšŒ) - ëŠë¦¬ì§€ë§Œ ë™ì‘!

                log.warn("Cache GET failed for key '{}': {}", key, e.getMessage());
                // ì˜ˆì™¸ë¥¼ ë˜ì§€ì§€ ì•ŠìŒ â†’ DBì—ì„œ ë°ì´í„° ì¡°íšŒ
            }

            @Override
            public void handleCachePutError(RuntimeException e, Cache cache, Object key, Object value) {
                // ğŸ” ì´ ë©”ì„œë“œëŠ” ì–¸ì œ í˜¸ì¶œë˜ëŠ”ê°€?
                // @Cacheable ë©”ì„œë“œì—ì„œ ê²°ê³¼ë¥¼ Redisì— ì €ì¥ ì‹¤íŒ¨ ì‹œ
                //
                // ğŸ” ì €ì¥ ì‹¤íŒ¨í•´ë„ ê´œì°®ì€ê°€?
                // - DB ì¡°íšŒ ê²°ê³¼ëŠ” ì´ë¯¸ ê°€ì ¸ì˜´
                // - ìºì‹œ ì €ì¥ë§Œ ì‹¤íŒ¨
                // - ë‹¤ìŒ ìš”ì²­ì—ì„œ ë‹¤ì‹œ ì‹œë„í•˜ë©´ ë¨

                log.warn("Cache PUT failed for key '{}': {}", key, e.getMessage());
            }

            @Override
            public void handleCacheEvictError(RuntimeException e, Cache cache, Object key) {
                // ğŸ” ì´ ë©”ì„œë“œëŠ” ì–¸ì œ í˜¸ì¶œë˜ëŠ”ê°€?
                // @CacheEvictì—ì„œ ìºì‹œ ì‚­ì œ ì‹¤íŒ¨ ì‹œ
                //
                // ğŸ” ì‚­ì œ ì‹¤íŒ¨í•˜ë©´?
                // - ì˜¤ë˜ëœ ìºì‹œê°€ ë‚¨ì•„ìˆì„ ìˆ˜ ìˆìŒ
                // - TTLì´ ì§€ë‚˜ë©´ ìë™ ì‚­ì œë¨
                // - ìµœì•…ì˜ ê²½ìš° ì‚¬ìš©ìê°€ ì˜¤ë˜ëœ ë°ì´í„°ë¥¼ ë³¼ ìˆ˜ ìˆìŒ
                // - í•˜ì§€ë§Œ ì„œë¹„ìŠ¤ëŠ” ê³„ì† ë™ì‘!

                log.warn("Cache EVICT failed for key '{}': {}", key, e.getMessage());
            }

            @Override
            public void handleCacheClearError(RuntimeException e, Cache cache) {
                log.warn("Cache CLEAR failed: {}", e.getMessage());
            }
        };
    }
}
```

### 2.1.3 ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤ë³„ ë™ì‘

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CacheErrorHandler ì ìš© í›„                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ì‹œë‚˜ë¦¬ì˜¤ 1: Redis ì •ìƒ                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  Client â†’ @Cacheable â†’ Redis HIT â†’ ì‘ë‹µ (10ms)                      â”‚
â”‚                                                                     â”‚
â”‚  ì‹œë‚˜ë¦¬ì˜¤ 2: Redis ë‹¤ìš´                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  Client â†’ @Cacheable â†’ Redis ì‹¤íŒ¨                                   â”‚
â”‚                       â†’ handleCacheGetError (ë¡œê·¸ë§Œ)                 â”‚
â”‚                       â†’ DB ì¡°íšŒ                                      â”‚
â”‚                       â†’ ì‘ë‹µ (100ms, ëŠë¦¬ì§€ë§Œ ë™ì‘!) âœ…              â”‚
â”‚                                                                     â”‚
â”‚  ì‹œë‚˜ë¦¬ì˜¤ 3: Redis ì €ì¥ ì‹¤íŒ¨                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
â”‚  Client â†’ @Cacheable â†’ Redis MISS â†’ DB ì¡°íšŒ                         â”‚
â”‚                       â†’ Redis ì €ì¥ ì‹œë„ â†’ ì‹¤íŒ¨                       â”‚
â”‚                       â†’ handleCachePutError (ë¡œê·¸ë§Œ)                 â”‚
â”‚                       â†’ ì‘ë‹µ (ì •ìƒ, ë‹¤ìŒì— ë‹¤ì‹œ ì‹œë„)                 â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2.2 Security & JWT ì¸ì¦ íë¦„

### 2.2.1 ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    JWT ì¸ì¦ ì „ì²´ íë¦„                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  [ë¡œê·¸ì¸ ì‹œ]                                                         â”‚
â”‚                                                                     â”‚
â”‚  1. Client: POST /api/auth/login {email, password}                  â”‚
â”‚       â”‚                                                             â”‚
â”‚       â–¼                                                             â”‚
â”‚  2. AuthController.login()                                          â”‚
â”‚       â”‚                                                             â”‚
â”‚       â–¼                                                             â”‚
â”‚  3. AuthenticationManager.authenticate()                            â”‚
â”‚       â”‚                                                             â”‚
â”‚       â”œâ”€â”€ CustomUserDetailsService.loadUserByUsername(email)        â”‚
â”‚       â”‚   â””â”€â”€ DBì—ì„œ ì‚¬ìš©ì ì¡°íšŒ                                     â”‚
â”‚       â”‚                                                             â”‚
â”‚       â””â”€â”€ PasswordEncoder.matches(ì…ë ¥, ì €ì¥ëœí•´ì‹œ)                  â”‚
â”‚           â””â”€â”€ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦                                          â”‚
â”‚       â”‚                                                             â”‚
â”‚       â–¼                                                             â”‚
â”‚  4. JwtTokenProvider.createAccessToken(userId, email, role)         â”‚
â”‚       â”‚                                                             â”‚
â”‚       â–¼                                                             â”‚
â”‚  5. Response: { accessToken, refreshToken, user }                   â”‚
â”‚       â”‚                                                             â”‚
â”‚       â–¼                                                             â”‚
â”‚  6. Client: accessTokenì„ ì¿ í‚¤/í—¤ë”ì— ì €ì¥                           â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ì¸ì¦ëœ ìš”ì²­ ì‹œ]                                                     â”‚
â”‚                                                                     â”‚
â”‚  1. Client: GET /api/projects (+ Cookie: accessToken=xxx)           â”‚
â”‚       â”‚                                                             â”‚
â”‚       â–¼                                                             â”‚
â”‚  2. JwtAuthenticationFilter.doFilterInternal()                      â”‚
â”‚       â”‚                                                             â”‚
â”‚       â”œâ”€â”€ ì¿ í‚¤ì—ì„œ accessToken ì¶”ì¶œ                                  â”‚
â”‚       â”‚                                                             â”‚
â”‚       â”œâ”€â”€ JwtTokenProvider.validateToken(token)                     â”‚
â”‚       â”‚   â””â”€â”€ ì„œëª… ê²€ì¦, ë§Œë£Œ í™•ì¸                                   â”‚
â”‚       â”‚                                                             â”‚
â”‚       â”œâ”€â”€ JwtTokenProvider.getUserIdFromToken(token)                â”‚
â”‚       â”‚   â””â”€â”€ Claimsì—ì„œ userId ì¶”ì¶œ                                 â”‚
â”‚       â”‚                                                             â”‚
â”‚       â”œâ”€â”€ CustomUserDetailsService.loadUserById(userId)             â”‚
â”‚       â”‚   â””â”€â”€ DBì—ì„œ ì‚¬ìš©ì ì¡°íšŒ                                     â”‚
â”‚       â”‚                                                             â”‚
â”‚       â””â”€â”€ SecurityContextHolder.setAuthentication(ì¸ì¦ì •ë³´)          â”‚
â”‚       â”‚                                                             â”‚
â”‚       â–¼                                                             â”‚
â”‚  3. ProjectController.getProjects() ì‹¤í–‰                            â”‚
â”‚       â”‚                                                             â”‚
â”‚       â”œâ”€â”€ @AuthenticationPrincipalë¡œ í˜„ì¬ ì‚¬ìš©ì ì •ë³´ íšë“           â”‚
â”‚       â”‚                                                             â”‚
â”‚       â–¼                                                             â”‚
â”‚  4. Response: { projects: [...] }                                   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2.2 SecurityConfig ìƒì„¸ í•´ì„¤

```java
@Configuration
@EnableWebSecurity      // Spring Security í™œì„±í™”
@EnableMethodSecurity   // @PreAuthorize ë“± ë©”ì„œë“œ ë³´ì•ˆ í™œì„±í™”
public class SecurityConfig {

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // 1. CORS ì„¤ì •
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            .cors(cors -> cors.configurationSource(corsConfigurationSource()))
            // ğŸ” ì™œ CORSê°€ í•„ìš”í•œê°€?
            // - ë¸Œë¼ìš°ì €ì˜ ë³´ì•ˆ ì •ì±…: ë‹¤ë¥¸ ë„ë©”ì¸ìœ¼ë¡œ ìš”ì²­ ì°¨ë‹¨
            // - Frontend(localhost:5173) â†’ Backend(localhost:8080)
            // - ë„ë©”ì¸ì´ ë‹¤ë¥´ë¯€ë¡œ CORS ì„¤ì • í•„ìš”

            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // 2. CSRF ë¹„í™œì„±í™”
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            .csrf(AbstractHttpConfigurer::disable)
            // ğŸ” ì™œ CSRFë¥¼ ë¹„í™œì„±í™”í•˜ëŠ”ê°€?
            // - CSRF: ì‚¬ìš©ì ëª¨ë¥´ê²Œ ì•…ì„± ìš”ì²­ ë³´ë‚´ëŠ” ê³µê²©
            // - ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦ì—ì„œ ì¤‘ìš” (ì¿ í‚¤ ìë™ ì „ì†¡ë˜ë¯€ë¡œ)
            // - JWTëŠ” í—¤ë”ì— í† í°ì„ ëª…ì‹œì ìœ¼ë¡œ ë³´ë‚´ë¯€ë¡œ CSRF ë¶ˆí•„ìš”
            // - REST APIëŠ” statelessì´ë¯€ë¡œ CSRF ë³´í˜¸ ë¶ˆí•„ìš”
            //
            // âš ï¸ ì£¼ì˜: ì¿ í‚¤ì— JWT ì €ì¥ ì‹œ CSRF ê³ ë ¤ í•„ìš”
            // - ìš°ë¦¬ëŠ” HttpOnly ì¿ í‚¤ ì‚¬ìš© â†’ XSS ë°©ì–´
            // - SameSite=Strict â†’ CSRF ë°©ì–´

            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // 3. ì„¸ì…˜ ì •ì±…
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            .sessionManagement(session ->
                session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
            // ğŸ” ì™œ STATELESSì¸ê°€?
            // - ì„¸ì…˜ì„ ì„œë²„ì— ì €ì¥í•˜ì§€ ì•ŠìŒ
            // - ëª¨ë“  ìš”ì²­ì— JWT í¬í•¨ â†’ ì„œë²„ëŠ” ìƒíƒœ ì—†ìŒ
            // - ì„œë²„ í™•ì¥ ìš©ì´ (ì–´ë–¤ ì„œë²„ë¡œ ìš”ì²­í•´ë„ ë™ì¼)
            //
            // ì„¸ì…˜ ì •ì±… ì¢…ë¥˜:
            // - ALWAYS: í•­ìƒ ì„¸ì…˜ ìƒì„±
            // - IF_REQUIRED: í•„ìš” ì‹œ ìƒì„± (ê¸°ë³¸ê°’)
            // - NEVER: ìƒì„± ì•ˆ í•¨, ìˆìœ¼ë©´ ì‚¬ìš©
            // - STATELESS: ì„¸ì…˜ ì™„ì „ ë¹„í™œì„±í™”

            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // 4. URLë³„ ì ‘ê·¼ ê¶Œí•œ
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            .authorizeHttpRequests(auth -> auth
                // ì¸ì¦ í•„ìš” (ëª…ì‹œì ìœ¼ë¡œ ë¨¼ì €!)
                .requestMatchers("/api/auth/me").authenticated()
                .requestMatchers("/api/auth/logout").authenticated()

                // ê³µê°œ ì—”ë“œí¬ì¸íŠ¸
                .requestMatchers("/api/auth/**").permitAll()
                // ğŸ” ì™œ authëŠ” ê³µê°œì¸ê°€?
                // - ë¡œê·¸ì¸, íšŒì›ê°€ì…ì€ ë¹„ë¡œê·¸ì¸ ìƒíƒœì—ì„œ ì ‘ê·¼
                // - /api/auth/meëŠ” ìœ„ì—ì„œ ë¨¼ì € authenticated() ì²˜ë¦¬

                .requestMatchers("/h2-console/**").permitAll()
                // ğŸ” ì™œ h2-consoleì€ ê³µê°œì¸ê°€?
                // - ê°œë°œ í™˜ê²½ì—ì„œ DB í™•ì¸ìš©
                // - í”„ë¡œë•ì…˜ì—ì„œëŠ” H2 ì‚¬ìš© ì•ˆ í•¨

                .requestMatchers("/ws/**").permitAll()
                // ğŸ” ì™œ WebSocketì€ ê³µê°œì¸ê°€?
                // - WebSocket ì—°ê²° ì‹œ ë³„ë„ë¡œ JWT ì¸ì¦
                // - HTTP ë ˆë²¨ì—ì„œëŠ” ì—°ê²°ë§Œ í—ˆìš©
                // - WebSocketAuthInterceptorì—ì„œ ì¸ì¦

                .requestMatchers("/actuator/**").permitAll()
                // ğŸ” ì™œ actuatorëŠ” ê³µê°œì¸ê°€?
                // - Docker healthcheckì—ì„œ ì ‘ê·¼ í•„ìš”
                // - í”„ë¡œë•ì…˜ì—ì„œëŠ” ì¼ë¶€ë§Œ ê³µê°œí•˜ëŠ” ê²Œ ì¢‹ìŒ

                .requestMatchers(HttpMethod.OPTIONS, "/**").permitAll()
                // ğŸ” ì™œ OPTIONSëŠ” ê³µê°œì¸ê°€?
                // - CORS preflight ìš”ì²­
                // - ë¸Œë¼ìš°ì €ê°€ ì‹¤ì œ ìš”ì²­ ì „ì— í—ˆìš© ì—¬ë¶€ í™•ì¸
                // - ì¸ì¦ í—¤ë” ì—†ì´ ë³´ë‚´ë¯€ë¡œ ê³µê°œ í•„ìš”

                // ë‚˜ë¨¸ì§€ëŠ” ì¸ì¦ í•„ìš”
                .anyRequest().authenticated()
            )

            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // 5. ì¸ì¦ ì œê³µì
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            .authenticationProvider(authenticationProvider())
            // ğŸ” AuthenticationProviderë€?
            // - ì‹¤ì œ ì¸ì¦ ë¡œì§ ë‹´ë‹¹
            // - UserDetailsServiceë¡œ ì‚¬ìš©ì ì¡°íšŒ
            // - PasswordEncoderë¡œ ë¹„ë°€ë²ˆí˜¸ ê²€ì¦

            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // 6. JWT í•„í„° ì¶”ê°€
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            .addFilterBefore(jwtAuthenticationFilter,
                UsernamePasswordAuthenticationFilter.class);
            // ğŸ” ì™œ Beforeì¸ê°€?
            // - UsernamePasswordAuthenticationFilter: í¼ ë¡œê·¸ì¸ ì²˜ë¦¬
            // - ìš°ë¦¬ëŠ” JWT ì‚¬ìš© â†’ ê·¸ ì „ì— JWT ê²€ì¦
            // - JWT ìœ íš¨í•˜ë©´ SecurityContextì— ì¸ì¦ ì •ë³´ ì„¤ì •
            // - UsernamePasswordAuthenticationFilterëŠ” ê±´ë„ˆëœ€

        return http.build();
    }
}
```

### 2.2.3 JWT í† í° êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    JWT í† í° êµ¬ì¡°                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIxIi...                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”‚
â”‚                       â”‚                                             â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚      â”‚                â”‚                â”‚                            â”‚
â”‚      â–¼                â–¼                â–¼                            â”‚
â”‚   Header           Payload         Signature                        â”‚
â”‚   (í—¤ë”)           (ë‚´ìš©)          (ì„œëª…)                            â”‚
â”‚                                                                     â”‚
â”‚   {                {                HMACSHA256(                     â”‚
â”‚     "alg":           "sub": "1",      header + "." + payload,       â”‚
â”‚     "HS256"          "email":         secret                        â”‚
â”‚   }                  "test@...",    )                               â”‚
â”‚                      "role":                                        â”‚
â”‚                      "USER",                                        â”‚
â”‚                      "type":                                        â”‚
â”‚                      "access",                                      â”‚
â”‚                      "exp":                                         â”‚
â”‚                      1706000000                                     â”‚
â”‚                    }                                                â”‚
â”‚                                                                     â”‚
â”‚   ğŸ” Header: ì•Œê³ ë¦¬ì¦˜ ì •ë³´                                           â”‚
â”‚   ğŸ” Payload: ì‚¬ìš©ì ì •ë³´ (Claims)                                   â”‚
â”‚   ğŸ” Signature: ìœ„ë³€ì¡° ë°©ì§€ ì„œëª…                                      â”‚
â”‚                                                                     â”‚
â”‚   âš ï¸ ì£¼ì˜: PayloadëŠ” Base64 ì¸ì½”ë”© (ì•”í˜¸í™” ì•„ë‹˜!)                     â”‚
â”‚   â†’ ëˆ„êµ¬ë‚˜ ë””ì½”ë”© ê°€ëŠ¥ â†’ ë¯¼ê° ì •ë³´ ë„£ì§€ ë§ ê²ƒ                          â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2.4 JwtAuthenticationFilter ìƒì„¸ í•´ì„¤

```java
@Component
public class JwtAuthenticationFilter extends OncePerRequestFilter {
    // ğŸ” ì™œ OncePerRequestFilterì¸ê°€?
    // - ìš”ì²­ë‹¹ í•œ ë²ˆë§Œ ì‹¤í–‰ ë³´ì¥
    // - FilterëŠ” ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œë  ìˆ˜ ìˆìŒ (í¬ì›Œë”© ë“±)
    // - ì¸ì¦ì€ í•œ ë²ˆë§Œ í•˜ë©´ ë¨

    @Override
    protected void doFilterInternal(
            HttpServletRequest request,
            HttpServletResponse response,
            FilterChain filterChain) throws ServletException, IOException {

        try {
            // 1. í† í° ì¶”ì¶œ
            String token = getTokenFromRequest(request);
            // ğŸ” ì¿ í‚¤ â†’ í—¤ë” ìˆœì„œë¡œ í™•ì¸
            // - ì¿ í‚¤: ë¸Œë¼ìš°ì €ì—ì„œ ìë™ ì „ì†¡ (í¸ë¦¬)
            // - í—¤ë”: ëª¨ë°”ì¼ ì•± ë“±ì—ì„œ ì‚¬ìš© (ìœ ì—°)

            // 2. í† í° ìœ íš¨ì„± ê²€ì¦
            if (StringUtils.hasText(token) && jwtTokenProvider.validateToken(token)) {
                // 3. í† í° íƒ€ì… í™•ì¸
                String tokenType = jwtTokenProvider.getTokenType(token);

                if ("access".equals(tokenType)) {
                    // ğŸ” ì™œ access í† í°ë§Œ í—ˆìš©í•˜ëŠ”ê°€?
                    // - Access Token: ì§§ì€ ìˆ˜ëª…, API ì ‘ê·¼ìš©
                    // - Refresh Token: ê¸´ ìˆ˜ëª…, í† í° ê°±ì‹ ìš©
                    // - Refresh Tokenìœ¼ë¡œ API í˜¸ì¶œí•˜ë©´ ì•ˆ ë¨!

                    // 4. ì‚¬ìš©ì ì •ë³´ ë¡œë“œ
                    Long userId = jwtTokenProvider.getUserIdFromToken(token);
                    UserDetails userDetails = userDetailsService.loadUserById(userId);
                    // ğŸ” ì™œ ë§¤ë²ˆ DB ì¡°íšŒí•˜ëŠ”ê°€?
                    // - ì‚¬ìš©ìê°€ ì‚­ì œ/ë¹„í™œì„±í™”ëì„ ìˆ˜ ìˆìŒ
                    // - ê¶Œí•œì´ ë³€ê²½ëì„ ìˆ˜ ìˆìŒ
                    // - í† í° ìœ íš¨í•´ë„ ì‚¬ìš©ì ìƒíƒœ í™•ì¸ í•„ìš”

                    // 5. ì¸ì¦ ê°ì²´ ìƒì„± ë° ì„¤ì •
                    UsernamePasswordAuthenticationToken authentication =
                        new UsernamePasswordAuthenticationToken(
                            userDetails,    // principal (í˜„ì¬ ì‚¬ìš©ì)
                            null,           // credentials (ë¹„ë°€ë²ˆí˜¸, ë¶ˆí•„ìš”)
                            userDetails.getAuthorities()  // ê¶Œí•œ ëª©ë¡
                        );

                    authentication.setDetails(
                        new WebAuthenticationDetailsSource().buildDetails(request)
                    );
                    // ğŸ” detailsì— ë­ê°€ ë“¤ì–´ê°€ëŠ”ê°€?
                    // - Remote IP ì£¼ì†Œ
                    // - Session ID (ìˆìœ¼ë©´)
                    // - ë¡œê¹…, ê°ì‚¬ì— ìœ ìš©

                    // 6. SecurityContextì— ì¸ì¦ ì •ë³´ ì €ì¥
                    SecurityContextHolder.getContext().setAuthentication(authentication);
                    // ğŸ” ì´í›„ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì–´ë–»ê²Œ ì ‘ê·¼í•˜ëŠ”ê°€?
                    // @AuthenticationPrincipal CustomUserDetails user
                    // â†’ principalì„ ìë™ ì£¼ì…
                }
            }
        } catch (Exception e) {
            logger.error("ì¸ì¦ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ", e);
            // ğŸ” ì™œ ì˜ˆì™¸ë¥¼ ì‚¼í‚¤ëŠ”ê°€?
            // - ì¸ì¦ ì‹¤íŒ¨í•´ë„ ìš”ì²­ì€ ê³„ì† ì§„í–‰
            // - permitAll() ì—”ë“œí¬ì¸íŠ¸ëŠ” ì¸ì¦ ì—†ì´ ì ‘ê·¼ ê°€ëŠ¥
            // - ì¸ì¦ í•„ìš”í•œ ê³³ì€ SecurityConfigì—ì„œ ì°¨ë‹¨ë¨
        }

        // 7. ë‹¤ìŒ í•„í„°ë¡œ ì§„í–‰
        filterChain.doFilter(request, response);
    }

    private String getTokenFromRequest(HttpServletRequest request) {
        // 1. ì¿ í‚¤ì—ì„œ ë¨¼ì € í™•ì¸
        Cookie[] cookies = request.getCookies();
        if (cookies != null) {
            for (Cookie cookie : cookies) {
                if ("accessToken".equals(cookie.getName())) {
                    return cookie.getValue();
                }
            }
        }

        // 2. Authorization í—¤ë”ì—ì„œ í™•ì¸
        String bearerToken = request.getHeader("Authorization");
        if (StringUtils.hasText(bearerToken) && bearerToken.startsWith("Bearer ")) {
            return bearerToken.substring(7);  // "Bearer " ì œê±°
        }

        return null;
    }
}
```

---

## 2.3 Database (JPA) ì„¤ì •

### 2.3.1 application.yml í”„ë¡œí•„ë³„ ì„¤ì •

```yaml
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ê°œë°œ í™˜ê²½ (dev) - H2 ì¸ë©”ëª¨ë¦¬ DB
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
spring:
  config:
    activate:
      on-profile: dev
  datasource:
    url: jdbc:h2:mem:blueprint;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    # ğŸ” H2 URL í•´ì„:
    # - jdbc:h2:mem: â†’ ì¸ë©”ëª¨ë¦¬ ëª¨ë“œ (ë””ìŠ¤í¬ ì €ì¥ ì•ˆ í•¨)
    # - blueprint â†’ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„
    # - DB_CLOSE_DELAY=-1 â†’ ì—°ê²° ëŠê²¨ë„ DB ìœ ì§€
    # - DB_CLOSE_ON_EXIT=FALSE â†’ JVM ì¢…ë£Œ ì‹œì—ë§Œ ì‚­ì œ

    driver-class-name: org.h2.Driver
    username: sa
    password:  # H2ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ì—†ìŒ

  h2:
    console:
      enabled: true
      path: /h2-console
      # ğŸ” http://localhost:8080/h2-console ì—ì„œ DB í™•ì¸ ê°€ëŠ¥

  jpa:
    hibernate:
      ddl-auto: create-drop
      # ğŸ” DDL ìë™ ìƒì„± ì˜µì…˜:
      # - create: ì‹œì‘ ì‹œ í…Œì´ë¸” ìƒì„± (ê¸°ì¡´ ì‚­ì œ)
      # - create-drop: ì‹œì‘ ì‹œ ìƒì„±, ì¢…ë£Œ ì‹œ ì‚­ì œ â† ê°œë°œìš©
      # - update: ë³€ê²½ì‚¬í•­ë§Œ ë°˜ì˜ (ì»¬ëŸ¼ ì¶”ê°€ ë“±)
      # - validate: ì—”í‹°í‹°ì™€ í…Œì´ë¸” ì¼ì¹˜ í™•ì¸ë§Œ
      # - none: ì•„ë¬´ê²ƒë„ ì•ˆ í•¨
      #
      # âš ï¸ í”„ë¡œë•ì…˜ì—ì„œëŠ” ì ˆëŒ€ create, create-drop ì‚¬ìš© ê¸ˆì§€!

    show-sql: true
    # ğŸ” ì‹¤í–‰ë˜ëŠ” SQL ë¡œê·¸ ì¶œë ¥ (ê°œë°œ ì‹œ ìœ ìš©)

    properties:
      hibernate:
        format_sql: true
        # ğŸ” SQLì„ ë³´ê¸° ì¢‹ê²Œ í¬ë§·íŒ…

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# í”„ë¡œë•ì…˜ í™˜ê²½ (prod) - PostgreSQL
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
---
spring:
  config:
    activate:
      on-profile: prod
  datasource:
    url: jdbc:postgresql://localhost:5432/blueprint
    driver-class-name: org.postgresql.Driver
    username: ${DB_USERNAME}  # í™˜ê²½ë³€ìˆ˜ë¡œ ì£¼ì…
    password: ${DB_PASSWORD}

  jpa:
    hibernate:
      ddl-auto: validate
      # ğŸ” ì™œ validateì¸ê°€?
      # - ì—”í‹°í‹°ì™€ í…Œì´ë¸”ì´ ì¼ì¹˜í•˜ëŠ”ì§€ë§Œ í™•ì¸
      # - ë¶ˆì¼ì¹˜ ì‹œ ì•± ì‹œì‘ ì‹¤íŒ¨ â†’ ë²„ê·¸ ì¡°ê¸° ë°œê²¬
      # - ì‹¤ì œ ìŠ¤í‚¤ë§ˆ ë³€ê²½ì€ Flyway/Liquibaseë¡œ

    show-sql: false
    # ğŸ” í”„ë¡œë•ì…˜ì—ì„œëŠ” SQL ë¡œê·¸ ë„ê¸° (ì„±ëŠ¥)

    properties:
      hibernate:
        format_sql: false
        dialect: org.hibernate.dialect.PostgreSQLDialect
        # ğŸ” ì™œ dialect ì§€ì •í•˜ëŠ”ê°€?
        # - PostgreSQL ì „ìš© SQL ë¬¸ë²• ì‚¬ìš©
        # - ì‹œí€€ìŠ¤, ë°°ì—´ íƒ€ì… ë“± PostgreSQL ê¸°ëŠ¥ í™œìš©
```

### 2.3.2 Entity ì„¤ê³„ íŒ¨í„´

```java
@Entity
@Table(name = "users")
// ğŸ” ì™œ í…Œì´ë¸” ì´ë¦„ì„ ëª…ì‹œí•˜ëŠ”ê°€?
// - Java: User (ë‹¨ìˆ˜, PascalCase)
// - DB: users (ë³µìˆ˜, snake_case)
// - ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´ "user" í…Œì´ë¸” ìƒì„± â†’ ì˜ˆì•½ì–´ ì¶©ëŒ!
public class User {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    // ğŸ” IDENTITY ì „ëµì´ë€?
    // - DBì˜ AUTO_INCREMENT ì‚¬ìš©
    // - PostgreSQL: SERIAL íƒ€ì…
    // - INSERT í›„ ìƒì„±ëœ ID ë°˜í™˜
    //
    // ë‹¤ë¥¸ ì „ëµë“¤:
    // - SEQUENCE: DB ì‹œí€€ìŠ¤ ì‚¬ìš© (PostgreSQL ê¶Œì¥)
    // - TABLE: ë³„ë„ í…Œì´ë¸”ë¡œ ì‹œí€€ìŠ¤ ê´€ë¦¬
    // - AUTO: DBì— ë§ê²Œ ìë™ ì„ íƒ
    private Long id;

    @Column(nullable = false, unique = true, length = 100)
    // ğŸ” Column ì†ì„± ì„¤ëª…:
    // - nullable = false â†’ NOT NULL ì œì•½ì¡°ê±´
    // - unique = true â†’ UNIQUE ì¸ë±ìŠ¤ ìë™ ìƒì„±
    // - length = 100 â†’ VARCHAR(100)
    private String email;

    @Column(nullable = false)
    private String password;
    // ğŸ” ë¹„ë°€ë²ˆí˜¸ëŠ” í•´ì‹œ ì €ì¥!
    // - BCrypt í•´ì‹œ: $2a$10$... (60ì)
    // - í‰ë¬¸ ì €ì¥ ì ˆëŒ€ ê¸ˆì§€

    @Column(name = "created_at", nullable = false, updatable = false)
    // ğŸ” ì™œ created_atìœ¼ë¡œ ì§€ì •í•˜ëŠ”ê°€?
    // - Java: createdAt (camelCase)
    // - DB: created_at (snake_case)
    // - ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´ "createdat" ìƒì„±
    //
    // ğŸ” updatable = falseë€?
    // - UPDATE ì‹œ ì´ ì»¬ëŸ¼ ì œì™¸
    // - ìƒì„± ì‹œê°„ì€ ìˆ˜ì • ë¶ˆê°€
    private LocalDateTime createdAt;

    @Enumerated(EnumType.STRING)
    // ğŸ” ì™œ STRINGì¸ê°€?
    // - ORDINAL: 0, 1, 2... ìˆ«ì ì €ì¥ (ê¸°ë³¸ê°’)
    //   â†’ ìˆœì„œ ë°”ë€Œë©´ ë°ì´í„° ê¼¬ì„!
    // - STRING: "USER", "ADMIN" ë¬¸ìì—´ ì €ì¥
    //   â†’ ê°€ë…ì„± ì¢‹ê³  ì•ˆì „
    private Role role = Role.USER;

    @Version
    // ğŸ” Optimistic Lockingìš© ë²„ì „ í•„ë“œ
    // - UPDATE ì‹œ ìë™ìœ¼ë¡œ version ì¦ê°€
    // - ë™ì‹œ ìˆ˜ì • ì‹œ ì¶©ëŒ ê°ì§€
    private Long version;

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ì—°ê´€ê´€ê³„ ì„¤ì •
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    @OneToMany(mappedBy = "user", cascade = CascadeType.ALL, orphanRemoval = true)
    // ğŸ” mappedByë€?
    // - ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ì—ì„œ "ì£¼ì¸ì´ ì•„ë‹Œ ìª½"
    // - ProjectMember.userê°€ ì‹¤ì œ FKë¥¼ ê°€ì§
    // - User ìª½ì—ì„œëŠ” ì¡°íšŒë§Œ ê°€ëŠ¥
    //
    // ğŸ” cascade = CascadeType.ALLì´ë€?
    // - User ì €ì¥ â†’ ProjectMemberë„ ìë™ ì €ì¥
    // - User ì‚­ì œ â†’ ProjectMemberë„ ìë™ ì‚­ì œ
    //
    // ğŸ” orphanRemoval = trueë€?
    // - members ë¦¬ìŠ¤íŠ¸ì—ì„œ ì œê±° â†’ DBì—ì„œë„ ì‚­ì œ
    // - ê³ ì•„ ê°ì²´ ìë™ ì‚­ì œ
    private List<ProjectMember> projectMembers = new ArrayList<>();

    @OneToMany(mappedBy = "user")
    // ğŸ” cascade ì—†ìŒ
    // - Notificationì€ Userì™€ ë³„ê°œë¡œ ê´€ë¦¬
    // - User ì‚­ì œ ì‹œ Notificationì€ ìœ ì§€ (í•„ìš”ì— ë”°ë¼)
    private List<Notification> notifications = new ArrayList<>();

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ìƒëª…ì£¼ê¸° ì½œë°±
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    @PrePersist
    // ğŸ” INSERT ì „ì— ìë™ ì‹¤í–‰
    protected void onCreate() {
        this.createdAt = LocalDateTime.now();
    }

    @PreUpdate
    // ğŸ” UPDATE ì „ì— ìë™ ì‹¤í–‰
    protected void onUpdate() {
        this.updatedAt = LocalDateTime.now();
    }
}
```

### 2.3.3 N+1 ë¬¸ì œì™€ í•´ê²°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    N+1 ë¬¸ì œë€?                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  // í”„ë¡œì íŠ¸ 10ê°œ ì¡°íšŒ                                               â”‚
â”‚  List<Project> projects = projectRepository.findAll();              â”‚
â”‚  // â†’ ì¿¼ë¦¬ 1ë²ˆ: SELECT * FROM projects                              â”‚
â”‚                                                                     â”‚
â”‚  for (Project p : projects) {                                       â”‚
â”‚      p.getMembers().size();  // ê° í”„ë¡œì íŠ¸ì˜ ë©¤ë²„ ì¡°íšŒ               â”‚
â”‚      // â†’ ì¿¼ë¦¬ 10ë²ˆ: SELECT * FROM project_members WHERE project_id = ?
â”‚  }                                                                  â”‚
â”‚                                                                     â”‚
â”‚  ì´ ì¿¼ë¦¬: 1 + 10 = 11ë²ˆ (N+1)                                       â”‚
â”‚  â†’ í”„ë¡œì íŠ¸ 1000ê°œë©´? 1001ë²ˆ!                                        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í•´ê²°ì±… 1: Fetch Join**
```java
public interface ProjectRepository extends JpaRepository<Project, Long> {

    @Query("SELECT p FROM Project p JOIN FETCH p.members WHERE p.id = :id")
    // ğŸ” JOIN FETCHë€?
    // - í•œ ë²ˆì˜ ì¿¼ë¦¬ë¡œ ì—°ê´€ ì—”í‹°í‹°ë„ í•¨ê»˜ ë¡œë“œ
    // - SELECT p.*, m.* FROM projects p JOIN project_members m ...
    Optional<Project> findByIdWithMembers(@Param("id") Long id);
}
```

**í•´ê²°ì±… 2: EntityGraph**
```java
@EntityGraph(attributePaths = {"members", "members.user"})
// ğŸ” EntityGraphë€?
// - ì–´ë–¤ ì—°ê´€ê´€ê³„ë¥¼ í•¨ê»˜ ë¡œë“œí• ì§€ ì„ ì–¸ì ìœ¼ë¡œ ì§€ì •
// - Fetch Joinë³´ë‹¤ ìœ ì—° (ë™ì ìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥)
Optional<Project> findById(Long id);
```

**í•´ê²°ì±… 3: Batch Size**
```yaml
spring:
  jpa:
    properties:
      hibernate:
        default_batch_fetch_size: 100
        # ğŸ” Batch Fetchë€?
        # - N+1 ì¿¼ë¦¬ë¥¼ IN ì¿¼ë¦¬ë¡œ ë³€í™˜
        # - WHERE id = 1, WHERE id = 2, ...
        # - â†’ WHERE id IN (1, 2, 3, ...)
        # - 100ê°œì”© ë¬¶ì–´ì„œ ì¡°íšŒ
```

---

# 3. í”„ë¡œì íŠ¸ êµ¬ì¡° ë° í”„ë¡œí•„ ì „ëµ

## 3.1 Layered Architecture

### 3.1.1 ì „ì²´ êµ¬ì¡°

```
backend/src/main/java/com/blueprint/
â”œâ”€â”€ adapter/                    # ì™¸ë¶€ ì„¸ê³„ì™€ì˜ ì—°ê²° (Adapter Layer)
â”‚   â”œâ”€â”€ in/                     # ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ ì²˜ë¦¬
â”‚   â”‚   â”œâ”€â”€ web/                # REST API ì»¨íŠ¸ë¡¤ëŸ¬
â”‚   â”‚   â”‚   â”œâ”€â”€ AuthController.java
â”‚   â”‚   â”‚   â”œâ”€â”€ ProjectController.java
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/            # ìš”ì²­/ì‘ë‹µ DTO
â”‚   â”‚   â”‚   â””â”€â”€ GlobalExceptionHandler.java
â”‚   â”‚   â””â”€â”€ websocket/          # WebSocket ì»¨íŠ¸ë¡¤ëŸ¬
â”‚   â”‚       â””â”€â”€ ProjectWebSocketController.java
â”‚   â””â”€â”€ out/                    # ë‚˜ê°€ëŠ” ìš”ì²­ ì²˜ë¦¬
â”‚       â””â”€â”€ persistence/        # DB ì ‘ê·¼ êµ¬í˜„ì²´
â”‚           â””â”€â”€ JpaUserRepository.java
â”‚
â”œâ”€â”€ application/                # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (Application Layer)
â”‚   â”œâ”€â”€ service/                # ì„œë¹„ìŠ¤ í´ë˜ìŠ¤
â”‚   â”‚   â”œâ”€â”€ AuthService.java
â”‚   â”‚   â”œâ”€â”€ ProjectService.java
â”‚   â”‚   â””â”€â”€ NodeService.java
â”‚   â”œâ”€â”€ dto/                    # ë‚´ë¶€ DTO
â”‚   â”‚   â””â”€â”€ ProjectResponse.java
â”‚   â””â”€â”€ exception/              # ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ˆì™¸
â”‚       â””â”€â”€ EntityNotFoundException.java
â”‚
â”œâ”€â”€ domain/                     # í•µì‹¬ ë„ë©”ì¸ (Domain Layer)
â”‚   â”œâ”€â”€ model/                  # ì—”í‹°í‹° í´ë˜ìŠ¤
â”‚   â”‚   â”œâ”€â”€ User.java
â”‚   â”‚   â”œâ”€â”€ Project.java
â”‚   â”‚   â””â”€â”€ Node.java
â”‚   â””â”€â”€ repository/             # ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤
â”‚       â”œâ”€â”€ UserRepository.java
â”‚       â””â”€â”€ ProjectRepository.java
â”‚
â”œâ”€â”€ infrastructure/             # ê¸°ìˆ ì  êµ¬í˜„ (Infrastructure Layer)
â”‚   â”œâ”€â”€ security/               # ë³´ì•ˆ ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ SecurityConfig.java
â”‚   â”‚   â””â”€â”€ JwtTokenProvider.java
â”‚   â”œâ”€â”€ redis/                  # Redis ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ RedisConfig.java
â”‚   â”‚   â””â”€â”€ RedisCacheService.java
â”‚   â””â”€â”€ websocket/              # WebSocket ì„¤ì •
â”‚       â””â”€â”€ WebSocketConfig.java
â”‚
â””â”€â”€ BlueprintApplication.java   # ë©”ì¸ í´ë˜ìŠ¤
```

### 3.1.2 ê° ë ˆì´ì–´ì˜ ì—­í• ê³¼ ì˜ì¡´ì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë ˆì´ì–´ ì˜ì¡´ì„± ê·œì¹™                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚  â”‚   Adapter   â”‚  â† HTTP ìš”ì²­/ì‘ë‹µ, DB ì ‘ê·¼                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚         â”‚ ì˜ì¡´                                                       â”‚
â”‚         â–¼                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚  â”‚ Application â”‚  â† ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§, íŠ¸ëœì­ì…˜                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚         â”‚ ì˜ì¡´                                                       â”‚
â”‚         â–¼                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚  â”‚   Domain    â”‚  â† ì—”í‹°í‹°, ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚         â–²                                                           â”‚
â”‚         â”‚ êµ¬í˜„                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚  â”‚Infrastructureâ”‚ â† ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­ (DB, Redis, Security)            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚                                                                     â”‚
â”‚  ğŸ” í•µì‹¬ ê·œì¹™:                                                       â”‚
â”‚  1. ì•ˆìª½ ë ˆì´ì–´ëŠ” ë°”ê¹¥ ë ˆì´ì–´ë¥¼ ëª¨ë¦„                                   â”‚
â”‚  2. Domainì€ ì–´ë–¤ ê²ƒë„ ì˜ì¡´í•˜ì§€ ì•ŠìŒ                                   â”‚
â”‚  3. InfrastructureëŠ” Domainì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„                        â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.1.3 ì™œ ì´ë ‡ê²Œ ë¶„ë¦¬í•˜ëŠ”ê°€?

**ì´ˆë³´ìë¥¼ ìœ„í•œ Why:**

```
ìƒí™©: UserRepository ì¸í„°í˜ì´ìŠ¤ì™€ JpaUserRepository êµ¬í˜„ì²´

// domain/repository/UserRepository.java (ì¸í„°í˜ì´ìŠ¤)
public interface UserRepository {
    Optional<User> findByEmail(String email);
    User save(User user);
}

// adapter/out/persistence/JpaUserRepository.java (êµ¬í˜„ì²´)
public interface JpaUserRepository extends JpaRepository<User, Long>, UserRepository {
    // JPAê°€ ìë™ êµ¬í˜„
}
```

**ğŸ” ì™œ ì¸í„°í˜ì´ìŠ¤ì™€ êµ¬í˜„ì²´ë¥¼ ë¶„ë¦¬í•˜ëŠ”ê°€?**

1. **í…ŒìŠ¤íŠ¸ ìš©ì´ì„±**
   ```java
   // í…ŒìŠ¤íŠ¸ì—ì„œ ê°€ì§œ êµ¬í˜„ì²´ ì‚¬ìš©
   class FakeUserRepository implements UserRepository {
       private Map<String, User> users = new HashMap<>();

       @Override
       public Optional<User> findByEmail(String email) {
           return Optional.ofNullable(users.get(email));
       }
   }

   // DB ì—†ì´ ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥!
   @Test
   void testLogin() {
       UserRepository repo = new FakeUserRepository();
       AuthService authService = new AuthService(repo);
       // ...
   }
   ```

2. **ê¸°ìˆ  ë³€ê²½ ìš©ì´ì„±**
   ```java
   // ì§€ê¸ˆ: JPA + PostgreSQL
   // ë‚˜ì¤‘: MongoDBë¡œ ë³€ê²½í•˜ê³  ì‹¶ë‹¤ë©´?

   // MongoUserRepository implements UserRepository
   // â†’ êµ¬í˜„ì²´ë§Œ ë°”ê¾¸ë©´ ë¨!
   // â†’ ì„œë¹„ìŠ¤ ì½”ë“œëŠ” ë³€ê²½ ì—†ìŒ
   ```

3. **ê´€ì‹¬ì‚¬ ë¶„ë¦¬**
   ```java
   // AuthServiceëŠ” "ì–´ë–»ê²Œ ì €ì¥ë˜ëŠ”ì§€" ëª°ë¼ë„ ë¨
   @Service
   public class AuthService {
       private final UserRepository userRepository;
       // JPAì¸ì§€, MongoDBì¸ì§€, ë©”ëª¨ë¦¬ì¸ì§€ ê´€ì‹¬ ì—†ìŒ
       // "ì €ì¥í•´ì¤˜, ì°¾ì•„ì¤˜"ë§Œ ì•Œë©´ ë¨
   }
   ```

---

## 3.2 Profile ì „ëµ

### 3.2.1 í”„ë¡œí•„ ì¢…ë¥˜

| í”„ë¡œí•„ | ìš©ë„ | ë°ì´í„°ë² ì´ìŠ¤ | Redis | íŠ¹ì§• |
|--------|------|------------|-------|------|
| `dev` | ë¡œì»¬ ê°œë°œ | H2 (ì¸ë©”ëª¨ë¦¬) | localhost:6379 | SQL ë¡œê·¸ ì¶œë ¥, H2 ì½˜ì†” í™œì„±í™” |
| `test` | í…ŒìŠ¤íŠ¸ | H2 (ì¸ë©”ëª¨ë¦¬) | localhost:6379 | ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ |
| `docker` | ë„ì»¤ í™˜ê²½ | PostgreSQL (ì»¨í…Œì´ë„ˆ) | redis:6379 | ì»¨í…Œì´ë„ˆ ê°„ í†µì‹  |
| `prod` | í”„ë¡œë•ì…˜ | PostgreSQL (ì™¸ë¶€) | ElastiCache | í™˜ê²½ë³€ìˆ˜ë¡œ ì„¤ì • |

### 3.2.2 í”„ë¡œí•„ í™œì„±í™” ë°©ë²•

```bash
# ë°©ë²• 1: í™˜ê²½ë³€ìˆ˜
export SPRING_PROFILES_ACTIVE=dev

# ë°©ë²• 2: JVM ì˜µì…˜
java -jar app.jar -Dspring.profiles.active=prod

# ë°©ë²• 3: application.yml
spring:
  profiles:
    active: dev

# ë°©ë²• 4: docker-compose í™˜ê²½ë³€ìˆ˜
environment:
  SPRING_PROFILES_ACTIVE: docker
```

### 3.2.3 í”„ë¡œí•„ë³„ ì„¤ì • íŒŒì¼ êµ¬ì¡°

```
src/main/resources/
â”œâ”€â”€ application.yml           # ê³µí†µ ì„¤ì • + ê¸°ë³¸ í”„ë¡œí•„(dev)
â”œâ”€â”€ application-docker.yml    # Docker ì „ìš© ì„¤ì •
â”œâ”€â”€ application-prod.yml      # í”„ë¡œë•ì…˜ ì „ìš© ì„¤ì • (ì„ íƒ)
â””â”€â”€ application-test.yml      # í…ŒìŠ¤íŠ¸ ì „ìš© ì„¤ì • (ì„ íƒ)
```

**ğŸ” ì™œ í•˜ë‚˜ì˜ íŒŒì¼ì— `---`ë¡œ êµ¬ë¶„í•˜ëŠ”ê°€?**

```yaml
# application.yml í•˜ë‚˜ì— ëª¨ë“  í”„ë¡œí•„ ì •ì˜ ê°€ëŠ¥

spring:
  profiles:
    active: dev  # ê¸°ë³¸ í”„ë¡œí•„

---
spring:
  config:
    activate:
      on-profile: dev
  # dev ì„¤ì •...

---
spring:
  config:
    activate:
      on-profile: prod
  # prod ì„¤ì •...
```

- **ì¥ì **: í•œ íŒŒì¼ì—ì„œ ëª¨ë“  ì„¤ì • ë¹„êµ ê°€ëŠ¥
- **ë‹¨ì **: íŒŒì¼ì´ ê¸¸ì–´ì§

**ë³„ë„ íŒŒì¼ ë¶„ë¦¬ ì‹œ:**
```yaml
# application.yml (ê³µí†µ)
spring:
  profiles:
    active: dev

# application-docker.yml (dockerë§Œ)
spring:
  datasource:
    url: jdbc:postgresql://postgres:5432/blueprint
```

---

# 4. ì´ˆë³´ìë¥¼ ìœ„í•œ ì—ëŸ¬ ì˜ˆë°© ë…¸íŠ¸

## 4.1 ìì£¼ ê²ªëŠ” ì—ëŸ¬ì™€ í•´ê²°ë²•

### 4.1.1 "Resolved to a type" ì—ëŸ¬

```
Error creating bean with name 'entityManagerFactory'
Could not determine recommended JdbcType for class XXX
```

**ì›ì¸:**
- Lombokì˜ @Dataë¥¼ Entityì— ì‚¬ìš©í–ˆì„ ë•Œ
- equals/hashCodeê°€ ì—°ê´€ê´€ê³„ë¥¼ í¬í•¨

**í•´ê²°:**
```java
// âŒ ì˜ëª»ëœ ë°©ë²•
@Data  // equals/hashCodeê°€ ëª¨ë“  í•„ë“œ í¬í•¨
@Entity
public class User {
    @OneToMany
    private List<Project> projects;  // ìˆœí™˜ ì°¸ì¡°!
}

// âœ… ì˜¬ë°”ë¥¸ ë°©ë²•
@Getter @Setter
@NoArgsConstructor
@Entity
public class User {
    @OneToMany
    private List<Project> projects;

    // equals/hashCodeëŠ” IDë§Œ ì‚¬ìš©
    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof User)) return false;
        return id != null && id.equals(((User) o).id);
    }

    @Override
    public int hashCode() {
        return getClass().hashCode();
    }
}
```

### 4.1.2 Docker í¬íŠ¸ ì¶©ëŒ

```
Error starting userland proxy: bind: address already in use
```

**ì›ì¸:**
- ì´ë¯¸ í•´ë‹¹ í¬íŠ¸ë¥¼ ì‚¬ìš© ì¤‘

**í•´ê²°:**
```bash
# í¬íŠ¸ ì‚¬ìš© ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸
# Windows
netstat -ano | findstr :5432

# Mac/Linux
lsof -i :5432

# í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ í›„ ì¬ì‹œë„
# ë˜ëŠ” docker-compose.ymlì—ì„œ í¬íŠ¸ ë³€ê²½
ports:
  - "5433:5432"  # í˜¸ìŠ¤íŠ¸ í¬íŠ¸ë¥¼ 5433ìœ¼ë¡œ ë³€ê²½
```

### 4.1.3 PostgreSQL ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜

```
FATAL: password authentication failed for user "blueprint"
```

**ì›ì¸:**
- docker-compose.ymlê³¼ application.ymlì˜ ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜
- ë˜ëŠ” ê¸°ì¡´ ë³¼ë¥¨ì— ë‹¤ë¥¸ ë¹„ë°€ë²ˆí˜¸ë¡œ ì´ˆê¸°í™”ë¨

**í•´ê²°:**
```bash
# ë³¼ë¥¨ ì‚­ì œ í›„ ì¬ì‹œì‘
docker-compose down -v
docker-compose up -d

# ë˜ëŠ” í™˜ê²½ë³€ìˆ˜ í™•ì¸
echo $DB_PASSWORD
```

### 4.1.4 JWT Secret ê¸¸ì´ ì—ëŸ¬

```
The specified key byte array is 128 bits which is not secure enough
```

**ì›ì¸:**
- JWT ì‹œí¬ë¦¿ í‚¤ê°€ 256ë¹„íŠ¸(32ì) ë¯¸ë§Œ

**í•´ê²°:**
```yaml
jwt:
  # âŒ ë„ˆë¬´ ì§§ìŒ
  secret: my-secret-key

  # âœ… 32ì ì´ìƒ
  secret: your-super-secret-jwt-key-for-development-min-256-bits
```

### 4.1.5 CORS ì—ëŸ¬

```
Access to XMLHttpRequest has been blocked by CORS policy
```

**ì›ì¸:**
- Frontendì™€ Backend ë„ë©”ì¸ì´ ë‹¤ë¦„
- CORS ì„¤ì • ëˆ„ë½ ë˜ëŠ” ì˜ëª»ë¨

**í•´ê²°:**
```java
// SecurityConfig.java
configuration.setAllowedOrigins(List.of(
    "http://localhost:5173",   // Vite ê°œë°œ ì„œë²„
    "http://localhost:3000",   // React ê°œë°œ ì„œë²„
    "http://localhost"         // Docker Nginx
));

configuration.setAllowCredentials(true);  // ì¿ í‚¤ í—ˆìš©
```

### 4.1.6 H2 Console ì ‘ê·¼ ë¶ˆê°€

```
Whitelabel Error Page - 403 Forbidden
```

**ì›ì¸:**
- Spring Securityê°€ ì°¨ë‹¨
- Frame ì˜µì…˜ì´ ì°¨ë‹¨

**í•´ê²°:**
```java
// SecurityConfig.java
.requestMatchers("/h2-console/**").permitAll()
// ...
.headers(headers -> headers.frameOptions(frame -> frame.sameOrigin()));
```

### 4.1.7 WebSocket ì—°ê²° ì‹¤íŒ¨

```
WebSocket connection failed: Error during WebSocket handshake
```

**ì›ì¸:**
- WebSocket ì—”ë“œí¬ì¸íŠ¸ ë³´ì•ˆ ì„¤ì •
- CORS ì„¤ì •

**í•´ê²°:**
```java
// SecurityConfig.java
.requestMatchers("/ws/**").permitAll()

// WebSocketConfig.java
registry.addEndpoint("/ws")
    .setAllowedOriginPatterns("*")  // ë˜ëŠ” íŠ¹ì • ë„ë©”ì¸
    .withSockJS();
```

---

## 4.2 í•„ìˆ˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 4.2.1 í”„ë¡œì íŠ¸ ì‹œì‘ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
â–¡ Docker Desktop ì‹¤í–‰ ì¤‘ì¸ê°€?
â–¡ í•„ìš”í•œ í¬íŠ¸ê°€ ë¹„ì–´ìˆëŠ”ê°€? (5432, 6379, 8080, 5173)
â–¡ .env íŒŒì¼ì´ ìˆëŠ”ê°€? (ë˜ëŠ” í™˜ê²½ë³€ìˆ˜ ì„¤ì •ë¨)
â–¡ JDK 17 ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ê°€?
â–¡ Node.js 18+ ì„¤ì¹˜ë˜ì–´ ìˆëŠ”ê°€?
```

### 4.2.2 Docker ì‹¤í–‰ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
â–¡ docker-compose.yml í™˜ê²½ë³€ìˆ˜ í™•ì¸
  â–¡ POSTGRES_PASSWORDì™€ SPRING_DATASOURCE_PASSWORD ì¼ì¹˜
  â–¡ JWT_SECRET 32ì ì´ìƒ
  â–¡ REDIS_HOSTê°€ ì»¨í…Œì´ë„ˆ ì´ë¦„ê³¼ ì¼ì¹˜

â–¡ í¬íŠ¸ ì¶©ëŒ í™•ì¸
  â–¡ 5432 (PostgreSQL)
  â–¡ 6379 (Redis)
  â–¡ 8080 (Backend)
  â–¡ 80 (Frontend)

â–¡ ë³¼ë¥¨ ìƒíƒœ í™•ì¸
  â–¡ ê¸°ì¡´ ë³¼ë¥¨ ë°ì´í„°ê°€ ìƒˆ ì„¤ì •ê³¼ í˜¸í™˜ë˜ëŠ”ê°€?
  â–¡ í•„ìš”ì‹œ docker-compose down -vë¡œ ì´ˆê¸°í™”
```

### 4.2.3 ì½”ë“œ ì‘ì„± ì‹œ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
â–¡ Entity í´ë˜ìŠ¤
  â–¡ @Data ëŒ€ì‹  @Getter @Setter ì‚¬ìš©
  â–¡ @Table(name = "ë³µìˆ˜í˜•_snake_case")
  â–¡ @Column(name = "snake_case") ëª…ì‹œ
  â–¡ @Version í•„ë“œ ì¶”ê°€ (Optimistic Locking)
  â–¡ equals/hashCodeëŠ” IDë§Œ ì‚¬ìš©

â–¡ Repository ì¸í„°í˜ì´ìŠ¤
  â–¡ Domain ë ˆì´ì–´ì— ì¸í„°í˜ì´ìŠ¤ ì •ì˜
  â–¡ Adapter ë ˆì´ì–´ì— JPA êµ¬í˜„ì²´

â–¡ Service í´ë˜ìŠ¤
  â–¡ @Transactional ì–´ë…¸í…Œì´ì…˜
  â–¡ ì¡°íšŒë§Œ í•˜ëŠ” ë©”ì„œë“œëŠ” @Transactional(readOnly = true)

â–¡ Controller í´ë˜ìŠ¤
  â–¡ @RestController ì‚¬ìš©
  â–¡ @RequestMappingìœ¼ë¡œ ê¸°ë³¸ ê²½ë¡œ ì„¤ì •
  â–¡ ìš”ì²­ DTOì— @Valid
  â–¡ ì¸ì¦ í•„ìš”í•œ ê³³ì— @AuthenticationPrincipal
```

### 4.2.4 ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
â–¡ í™˜ê²½ë³€ìˆ˜
  â–¡ JWT_SECRET í”„ë¡œë•ì…˜ìš©ìœ¼ë¡œ ë³€ê²½
  â–¡ DB_PASSWORD ì•ˆì „í•œ ë¹„ë°€ë²ˆí˜¸
  â–¡ REDIS_PASSWORD ì„¤ì •

â–¡ ë³´ì•ˆ
  â–¡ H2 ì½˜ì†” ë¹„í™œì„±í™” (í”„ë¡œë•ì…˜)
  â–¡ Actuator ì—”ë“œí¬ì¸íŠ¸ ì œí•œ
  â–¡ CORS í—ˆìš© ë„ë©”ì¸ ì œí•œ
  â–¡ ddl-auto: validate í™•ì¸

â–¡ ë¡œê¹…
  â–¡ SQL ë¡œê·¸ ë¹„í™œì„±í™”
  â–¡ ì ì ˆí•œ ë¡œê·¸ ë ˆë²¨ (INFO)

â–¡ í…ŒìŠ¤íŠ¸
  â–¡ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼
  â–¡ Docker í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸
```

---

# 5. ë¶€ë¡: ë¹ ë¥¸ ì°¸ì¡° ì²´í¬ë¦¬ìŠ¤íŠ¸

## 5.1 ìƒˆ Entity ì¶”ê°€ ì‹œ

```
1. domain/model/ì— Entity í´ë˜ìŠ¤ ìƒì„±
   â–¡ @Entity, @Table(name = "ë³µìˆ˜í˜•")
   â–¡ @Id, @GeneratedValue
   â–¡ @Column ëª…ì‹œ (snake_case)
   â–¡ @Version ì¶”ê°€
   â–¡ equals/hashCode (IDë§Œ)

2. domain/repository/ì— ì¸í„°í˜ì´ìŠ¤ ìƒì„±
   â–¡ í•„ìš”í•œ ë©”ì„œë“œë§Œ ì •ì˜

3. adapter/out/persistence/ì— JPA êµ¬í˜„ì²´ ìƒì„±
   â–¡ JpaRepository ìƒì†
   â–¡ domain ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„

4. application/service/ì— Service ìƒì„±
   â–¡ @Service, @RequiredArgsConstructor
   â–¡ @Transactional

5. adapter/in/web/ì— Controller ìƒì„±
   â–¡ @RestController, @RequestMapping
   â–¡ DTO ì •ì˜

6. í…ŒìŠ¤íŠ¸ ì‘ì„±
```

## 5.2 ìƒˆ API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€ ì‹œ

```
1. DTO ì •ì˜ (adapter/in/web/dto/)
   â–¡ Request DTO (ì…ë ¥ ê²€ì¦ ì–´ë…¸í…Œì´ì…˜)
   â–¡ Response DTO

2. Controller ë©”ì„œë“œ ì¶”ê°€
   â–¡ HTTP ë©”ì„œë“œ ì–´ë…¸í…Œì´ì…˜ (@GetMapping ë“±)
   â–¡ @Valid ê²€ì¦
   â–¡ ì ì ˆí•œ HTTP ìƒíƒœ ì½”ë“œ

3. Service ë©”ì„œë“œ ì¶”ê°€
   â–¡ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
   â–¡ íŠ¸ëœì­ì…˜ ê²½ê³„

4. í•„ìš”ì‹œ Repository ë©”ì„œë“œ ì¶”ê°€
   â–¡ Query ë©”ì„œë“œ ëª…ëª… ê·œì¹™
   â–¡ ë˜ëŠ” @Query ì‚¬ìš©

5. SecurityConfig í™•ì¸
   â–¡ ì¸ì¦ í•„ìš” ì—¬ë¶€ ì„¤ì •

6. í…ŒìŠ¤íŠ¸ ì‘ì„±
   â–¡ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
   â–¡ í†µí•© í…ŒìŠ¤íŠ¸
```

## 5.3 ìì£¼ ì“°ëŠ” ëª…ë ¹ì–´

```bash
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Docker
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
docker-compose up -d          # ì„œë¹„ìŠ¤ ì‹œì‘
docker-compose down           # ì„œë¹„ìŠ¤ ì¤‘ì§€
docker-compose down -v        # ì„œë¹„ìŠ¤ + ë³¼ë¥¨ ì‚­ì œ
docker-compose logs -f backend  # ë°±ì—”ë“œ ë¡œê·¸ í™•ì¸
docker exec -it blueprint-db psql -U blueprint -d blueprint  # DB ì ‘ì†

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Gradle (backend ë””ë ‰í† ë¦¬ì—ì„œ)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
./gradlew bootRun             # ì•± ì‹¤í–‰
./gradlew test                # í…ŒìŠ¤íŠ¸ ì‹¤í–‰
./gradlew build               # ë¹Œë“œ
./gradlew clean build         # í´ë¦° ë¹Œë“œ

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# npm (frontend ë””ë ‰í† ë¦¬ì—ì„œ)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
npm run dev                   # ê°œë°œ ì„œë²„ ì‹¤í–‰
npm run build                 # í”„ë¡œë•ì…˜ ë¹Œë“œ
npm run test                  # í…ŒìŠ¤íŠ¸ ì‹¤í–‰

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Git
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
git status                    # ìƒíƒœ í™•ì¸
git add -p                    # ë³€ê²½ì‚¬í•­ ì„ íƒì  ìŠ¤í…Œì´ì§•
git commit -m "feat: ê¸°ëŠ¥ ì¶”ê°€"
git push origin feature/xxx
```

---

## ë§ˆë¬´ë¦¬

ì´ ë¬¸ì„œëŠ” Blueprint í”„ë¡œì íŠ¸ì˜ ëª¨ë“  ì„¤ê³„ ê²°ì •ê³¼ ê·¸ ì´ìœ ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.
ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•  ë•Œ ì´ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ë©´ ê°™ì€ ì‹¤ìˆ˜ë¥¼ ë°˜ë³µí•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ê¸°ì–µí•˜ì„¸ìš”:**
1. ëª¨ë“  ì„¤ì •ì—ëŠ” ì´ìœ ê°€ ìˆìŠµë‹ˆë‹¤
2. ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì˜ ì½ìœ¼ë©´ 80%ëŠ” í•´ê²°ë©ë‹ˆë‹¤
3. ê³µì‹ ë¬¸ì„œê°€ ê°€ì¥ ì¢‹ì€ ì°¸ê³  ìë£Œì…ë‹ˆë‹¤

---

*ì‘ì„±ì¼: 2026-01-26*
*í”„ë¡œì íŠ¸: Blueprint - ì‹¤ì‹œê°„ í˜‘ì—… ì•„í‚¤í…ì²˜ í”Œë˜ë‹ ë„êµ¬*
